{"ast":null,"code":"var __extends = this && this.__extends || function () {\n  var extendStatics = function (d, b) {\n    extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    };\n\n    return extendStatics(d, b);\n  };\n\n  return function (d, b) {\n    extendStatics(d, b);\n\n    function __() {\n      this.constructor = d;\n    }\n\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\n/* eslint-disable @typescript-eslint/no-explicit-any */\n\n\nimport { createElement, closest, Draggable, extend, formatUnit, isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { addClass, remove, removeClass, setStyleAttribute } from '@syncfusion/ej2-base';\nimport { ActionBase } from '../actions/action-base';\nimport { MonthEvent } from '../event-renderer/month';\nimport { TimelineEvent } from '../event-renderer/timeline-view';\nimport { YearEvent } from '../event-renderer/year';\nimport { VerticalEvent } from '../event-renderer/vertical-view';\nimport * as cls from '../base/css-constant';\nimport * as events from '../base/constant';\nimport * as util from '../base/util';\nvar MINUTES_PER_DAY = 1440;\n/**\n * Schedule events drag actions\n */\n\nvar DragAndDrop = function (_super) {\n  __extends(DragAndDrop, _super);\n\n  function DragAndDrop() {\n    var _this = _super !== null && _super.apply(this, arguments) || this;\n\n    _this.widthUptoCursorPoint = 0;\n    _this.heightUptoCursorPoint = 0;\n    _this.cursorPointIndex = 0;\n    _this.isHeaderRows = false;\n    _this.isTimelineDayProcess = false;\n    _this.widthPerMinute = 0;\n    _this.heightPerMinute = 0;\n    _this.minDiff = 0;\n    _this.isStepDragging = false;\n    _this.isMorePopupOpened = false;\n    _this.isAllDayDrag = false;\n    _this.isMultiSelect = false;\n    _this.multiData = [];\n    _this.updatedData = [];\n    _this.swagData = [];\n    _this.startTime = 0;\n    _this.isAllDayTarget = false;\n    _this.targetTd = null;\n    _this.isCursorAhead = false;\n    return _this;\n  }\n\n  DragAndDrop.prototype.wireDragEvent = function (element) {\n    var dragElement = document.querySelector(this.parent.eventDragArea);\n    new Draggable(element, {\n      abort: '.' + cls.EVENT_RESIZE_CLASS,\n      clone: true,\n      isDragScroll: true,\n      enableTapHold: this.parent.isAdaptive,\n      enableTailMode: this.parent.eventDragArea ? true : false,\n      cursorAt: this.parent.eventDragArea ? {\n        left: -20,\n        top: -20\n      } : {\n        left: 0,\n        top: 0\n      },\n      dragArea: this.parent.eventDragArea && dragElement ? dragElement : this.parent.element.querySelector('.' + cls.CONTENT_TABLE_CLASS),\n      dragStart: this.dragStart.bind(this),\n      drag: this.drag.bind(this),\n      dragStop: this.dragStop.bind(this),\n      enableAutoScroll: false,\n      helper: this.dragHelper.bind(this),\n      queryPositionInfo: this.dragPosition.bind(this)\n    });\n  };\n\n  DragAndDrop.prototype.dragHelper = function (e) {\n    var _this = this;\n\n    this.setDragActionDefaultValues();\n    this.actionObj.element = e.element;\n    this.actionObj.action = 'drag';\n    var elements = [];\n\n    if (!this.parent.allowMultiDrag || isNullOrUndefined(this.parent.selectedElements) || this.parent.selectedElements.length === 0 || this.parent.selectedElements.length > 0 && this.parent.selectedElements.indexOf(this.actionObj.element) === -1) {\n      elements = [e.element];\n    } else {\n      elements = this.parent.selectedElements;\n      this.isMultiSelect = true;\n    }\n\n    elements.forEach(function (ele) {\n      var cloneElement = _this.createCloneElement(ele);\n\n      if (ele.getAttribute('data-guid') === _this.actionObj.element.getAttribute('data-guid')) {\n        _this.actionObj.clone = cloneElement;\n\n        if (!_this.parent.eventDragArea && _this.parent.currentView !== 'Month' && _this.parent.activeViewOptions.timeScale.enable && !_this.parent.activeView.isTimelineView() && !_this.actionObj.element.classList.contains(cls.ALLDAY_APPOINTMENT_CLASS)) {\n          setStyleAttribute(_this.actionObj.clone, {\n            cursor: 'move',\n            left: '0%',\n            right: '0%',\n            width: '100%'\n          });\n        }\n\n        _this.actionObj.clone.style.top = formatUnit(_this.actionObj.element.offsetTop);\n      }\n\n      _this.actionObj.cloneElement.push(cloneElement);\n\n      _this.actionObj.originalElement.push(ele);\n    });\n    return this.actionObj.clone;\n  };\n\n  DragAndDrop.prototype.dragPosition = function (e) {\n    if (this.parent.eventDragArea) {\n      return {\n        left: e.left,\n        top: e.top\n      };\n    }\n\n    var cellHeight = this.actionObj.cellHeight / this.actionObj.slotInterval * this.actionObj.interval;\n    var leftValue = formatUnit(0);\n\n    if (this.parent.currentView === 'Month') {\n      leftValue = e.left;\n    }\n\n    var cloneRight;\n\n    if (this.isStepDragging) {\n      cloneRight = Math.ceil(this.actionObj.clone.getBoundingClientRect().right) + this.actionObj.interval;\n    } else {\n      cloneRight = this.actionObj.clone.getBoundingClientRect().right;\n    }\n\n    var dragArea = this.parent.element.querySelector('.' + cls.CONTENT_WRAP_CLASS);\n    var contentWrapRight = dragArea.getBoundingClientRect().right;\n\n    if (this.parent.activeView.isTimelineView() && this.parent.currentView !== 'TimelineYear' && !this.parent.enableRtl && this.actionObj.pageX > cloneRight && !this.isMorePopupOpened && !(this.actionObj.pageX > contentWrapRight)) {\n      this.isCursorAhead = true;\n    }\n\n    if (this.parent.activeView.isTimelineView()) {\n      leftValue = formatUnit(this.actionObj.clone.offsetLeft);\n    }\n\n    var topValue;\n\n    if (this.parent.activeView.isTimelineView() || !this.parent.timeScale.enable || !isNullOrUndefined(this.actionObj.clone.offsetParent) && this.actionObj.clone.offsetParent.classList.contains(cls.MORE_EVENT_POPUP_CLASS)) {\n      topValue = formatUnit(this.actionObj.clone.offsetTop);\n    } else if (this.parent.currentView === 'Month') {\n      topValue = formatUnit(0);\n    } else if (this.actionObj.clone.classList.contains(cls.ALLDAY_APPOINTMENT_CLASS)) {\n      topValue = formatUnit(this.parent.element.querySelector('.' + cls.ALLDAY_ROW_CLASS).offsetTop);\n      setStyleAttribute(this.actionObj.clone, {\n        width: formatUnit(Math.ceil(this.actionObj.clone.offsetWidth / this.actionObj.cellWidth) * this.actionObj.cellWidth),\n        right: this.parent.enableRtl && formatUnit(0)\n      });\n    } else {\n      if (this.actionObj.element.classList.contains(cls.ALLDAY_APPOINTMENT_CLASS) && !this.actionObj.clone.classList.contains(cls.ALLDAY_APPOINTMENT_CLASS)) {\n        setStyleAttribute(this.actionObj.clone, {\n          height: formatUnit(this.actionObj.cellHeight),\n          width: formatUnit(this.actionObj.cellWidth - 1),\n          pointerEvents: 'none'\n        });\n      }\n\n      var top_1 = parseInt(e.top, 10);\n      top_1 = top_1 < 0 ? 0 : top_1;\n      topValue = formatUnit(Math.ceil(top_1 / cellHeight) * cellHeight);\n      var scrollHeight = this.parent.element.querySelector('.e-content-wrap').scrollHeight;\n      var cloneBottom = parseInt(topValue, 10) + this.actionObj.clone.offsetHeight;\n\n      if (cloneBottom > scrollHeight) {\n        topValue = parseInt(topValue, 10) - (cloneBottom - scrollHeight) + 'px';\n      }\n    }\n\n    return {\n      left: leftValue,\n      top: topValue\n    };\n  };\n\n  DragAndDrop.prototype.setDragActionDefaultValues = function () {\n    this.actionObj.action = 'drag';\n    this.actionObj.isAllDay = null;\n    this.actionObj.slotInterval = this.parent.activeViewOptions.timeScale.interval / this.parent.activeViewOptions.timeScale.slotCount;\n    this.actionObj.interval = this.actionObj.slotInterval;\n    var workCell = this.parent.element.querySelector('.' + cls.WORK_CELLS_CLASS);\n    this.actionObj.cellWidth = workCell.offsetWidth;\n    this.actionObj.cellHeight = workCell.offsetHeight;\n  };\n\n  DragAndDrop.prototype.dragStart = function (e) {\n    var _this = this;\n\n    var eventGuid = this.actionObj.element.getAttribute('data-guid');\n    this.actionObj.event = this.parent.eventBase.getEventByGuid(eventGuid);\n    var eventObj = extend({}, this.actionObj.event, null, true);\n    this.startTime = eventObj[this.parent.eventFields.startTime].getTime();\n    var dragArgs = {\n      cancel: false,\n      data: eventObj,\n      selectedData: this.getSelectedData(),\n      event: e,\n      excludeSelectors: null,\n      element: this.actionObj.element,\n      interval: this.actionObj.interval,\n      navigation: {\n        enable: false,\n        timeDelay: 2000\n      },\n      scroll: {\n        enable: true,\n        scrollBy: 30,\n        timeDelay: 100\n      }\n    };\n    this.parent.trigger(events.dragStart, dragArgs, function (dragEventArgs) {\n      if (dragEventArgs.cancel || !isNullOrUndefined(_this.actionObj.element) && isNullOrUndefined(_this.actionObj.element.parentElement)) {\n        var dragObj = _this.actionObj.element.ej2_instances[0];\n\n        if (!isNullOrUndefined(dragObj)) {\n          dragObj.intDestroy(e.event);\n        }\n\n        _this.actionObj.action = '';\n\n        _this.removeCloneElementClasses();\n\n        _this.removeCloneElement();\n\n        return;\n      }\n\n      _this.actionClass('addClass');\n\n      _this.parent.uiStateValues.action = true;\n      _this.actionObj.start = eventObj[_this.parent.eventFields.startTime];\n      _this.actionObj.end = eventObj[_this.parent.eventFields.endTime];\n      _this.actionObj.groupIndex = parseInt(_this.actionObj.element.getAttribute('data-group-index') || '0', 10);\n      _this.actionObj.interval = dragEventArgs.interval;\n      _this.actionObj.navigation = dragEventArgs.navigation;\n      _this.actionObj.scroll = dragEventArgs.scroll;\n      _this.actionObj.excludeSelectors = dragEventArgs.excludeSelectors;\n\n      var viewElement = _this.parent.element.querySelector('.' + cls.CONTENT_WRAP_CLASS);\n\n      _this.scrollArgs = {\n        element: viewElement,\n        width: viewElement.scrollWidth,\n        height: viewElement.scrollHeight\n      };\n      _this.widthPerMinute = _this.actionObj.cellWidth / _this.actionObj.slotInterval * _this.actionObj.interval;\n      _this.heightPerMinute = _this.actionObj.cellHeight / _this.actionObj.slotInterval * _this.actionObj.interval;\n      _this.widthUptoCursorPoint = 0;\n      _this.heightUptoCursorPoint = 0;\n      _this.cursorPointIndex = -1;\n      _this.isHeaderRows = false;\n      _this.isTimelineDayProcess = false;\n      _this.minDiff = 0;\n      _this.isMorePopupOpened = false;\n      _this.daysVariation = -1;\n      _this.isAllDayTarget = _this.actionObj.clone.classList.contains(cls.ALLDAY_APPOINTMENT_CLASS);\n\n      if ((_this.parent.activeView.isTimelineView() || !_this.parent.timeScale.enable) && _this.parent.currentView !== 'TimelineYear') {\n        if (!isNullOrUndefined(_this.actionObj.clone.offsetParent) && _this.actionObj.clone.offsetParent.classList.contains(cls.MORE_EVENT_POPUP_CLASS)) {\n          _this.isMorePopupOpened = true;\n        }\n\n        _this.actionObj.pageX = e.event.pageX;\n        var rows = _this.parent.activeViewOptions.headerRows;\n        _this.isHeaderRows = rows.length > 0 && rows[rows.length - 1].option !== 'Hour' && rows[rows.length - 1].option !== 'Date';\n        _this.isTimelineDayProcess = !_this.parent.activeViewOptions.timeScale.enable || _this.isHeaderRows || _this.parent.currentView === 'TimelineMonth' || rows.length > 0 && rows[rows.length - 1].option === 'Date';\n        _this.isStepDragging = !_this.isTimelineDayProcess && _this.actionObj.slotInterval !== _this.actionObj.interval;\n\n        if (_this.isTimelineDayProcess) {\n          _this.timelineEventModule = new TimelineEvent(_this.parent, 'day');\n        } else {\n          _this.timelineEventModule = new TimelineEvent(_this.parent, 'hour');\n        }\n      }\n\n      if (_this.parent.currentView === 'TimelineYear') {\n        _this.yearEvent = new YearEvent(_this.parent);\n      }\n\n      if (_this.parent.currentView === 'Month') {\n        _this.startTime = util.resetTime(new Date(_this.startTime)).getTime();\n\n        _this.updateOriginalElement(_this.actionObj.clone);\n\n        _this.monthEvent = new MonthEvent(_this.parent);\n      }\n\n      if (_this.parent.currentView === 'Day' || _this.parent.currentView === 'Week' || _this.parent.currentView === 'WorkWeek') {\n        _this.verticalEvent = new VerticalEvent(_this.parent);\n\n        _this.verticalEvent.initializeValues();\n\n        var splitEvents = _this.splitEvent(_this.actionObj.event);\n\n        splitEvents.forEach(function (event) {\n          var query = \".e-day-wrapper[data-date=\\\"\" + util.resetTime(event[_this.parent.eventFields.startTime]).getTime() + \"\\\"]\";\n\n          if (_this.parent.activeViewOptions.group.resources.length > 0) {\n            query = query.concat('[data-group-index = \"' + _this.actionObj.groupIndex + '\"]');\n          }\n\n          var appWrap = _this.parent.element.querySelector(query);\n\n          if (appWrap) {\n            var appEle = appWrap.querySelector('[data-id=\"' + _this.actionObj.clone.getAttribute('data-id') + '\"]');\n\n            if (appEle) {\n              addClass([appEle], cls.EVENT_ACTION_CLASS);\n            }\n          }\n        });\n      }\n    });\n  };\n\n  DragAndDrop.prototype.getSelectedData = function () {\n    if (this.isMultiSelect && this.multiData.length === 0 && this.parent.selectedElements.length > 0) {\n      for (var _i = 0, _a = this.parent.selectedElements; _i < _a.length; _i++) {\n        var element = _a[_i];\n        var eventGuid = element.getAttribute('data-guid');\n        var data = this.parent.eventBase.getEventByGuid(eventGuid);\n        this.multiData.push(extend({}, data, null, true));\n      }\n    }\n\n    return this.multiData;\n  };\n\n  DragAndDrop.prototype.drag = function (e) {\n    if (this.parent.quickPopup) {\n      this.parent.quickPopup.quickPopupHide(true);\n    }\n\n    if (!isNullOrUndefined(e.target) && e.target.classList.contains(cls.DISABLE_DATES)) {\n      return;\n    }\n\n    var eventObj = extend({}, this.actionObj.event, null, true);\n    var eventArgs = this.getPageCoordinates(e);\n    this.actionObj.Y = this.actionObj.pageY = eventArgs.pageY;\n    this.actionObj.X = this.actionObj.pageX = eventArgs.pageX;\n    this.actionObj.target = e.target;\n    this.widthUptoCursorPoint = this.widthUptoCursorPoint === 0 ? Math.ceil(Math.abs(this.actionObj.clone.getBoundingClientRect().left - this.actionObj.X) / this.widthPerMinute) * this.widthPerMinute : this.widthUptoCursorPoint;\n    this.widthUptoCursorPoint = this.isMorePopupOpened ? this.actionObj.cellWidth : this.widthUptoCursorPoint;\n    this.heightUptoCursorPoint = this.heightUptoCursorPoint === 0 ? Math.ceil(Math.abs(this.actionObj.clone.getBoundingClientRect().top - this.actionObj.Y) / this.heightPerMinute) * this.heightPerMinute : this.heightUptoCursorPoint;\n    this.isAllDayDrag = this.parent.activeViewOptions.timeScale.enable ? this.actionObj.clone.classList.contains(cls.ALLDAY_APPOINTMENT_CLASS) : this.actionObj.event[this.parent.eventFields.isAllDay];\n\n    if (this.isStepDragging && this.minDiff === 0) {\n      this.calculateMinutesDiff(eventObj);\n    }\n\n    if ((this.parent.currentView === 'Month' || this.isAllDayDrag) && this.daysVariation < 0) {\n      var date = this.parent.getDateFromElement(this.actionObj.target);\n\n      if (!isNullOrUndefined(date)) {\n        var currentDate = util.resetTime(date);\n        var startDate = util.resetTime(new Date(eventObj[this.parent.eventFields.startTime].getTime()));\n        this.daysVariation = (currentDate.getTime() - startDate.getTime()) / util.MS_PER_DAY;\n      } else {\n        this.daysVariation = 0;\n      }\n    } else {\n      this.daysVariation = 0;\n    }\n\n    if (this.parent.eventDragArea) {\n      var targetElement = eventArgs.target;\n      this.actionObj.clone.style.top = formatUnit(targetElement.offsetTop);\n      this.actionObj.clone.style.left = formatUnit(targetElement.offsetLeft);\n      var currentTarget = closest(targetElement, '.' + cls.ROOT);\n\n      if (!currentTarget) {\n        this.actionObj.clone.style.height = '';\n        this.actionObj.clone.style.width = '';\n      } else {\n        if (!(this.parent.currentView === 'Week' || this.parent.currentView === 'WorkWeek' || this.parent.currentView === 'Day')) {\n          this.actionObj.clone.style.width = formatUnit(this.actionObj.element.offsetWidth);\n        }\n      }\n    }\n\n    this.updateScrollPosition(e);\n    this.updateNavigatingPosition(e);\n    this.updateDraggingDateTime(e);\n    var dragArgs = {\n      data: eventObj,\n      event: e,\n      element: this.actionObj.element,\n      startTime: this.actionObj.start,\n      endTime: this.actionObj.end,\n      selectedData: this.updatedData\n    };\n\n    if (this.parent.group.resources.length > 0) {\n      dragArgs.groupIndex = this.actionObj.groupIndex;\n    }\n\n    this.parent.trigger(events.drag, dragArgs);\n  };\n\n  DragAndDrop.prototype.calculateMinutesDiff = function (eventObj) {\n    if (this.parent.enableRtl) {\n      this.minDiff = (this.actionObj.clone.offsetWidth - this.widthUptoCursorPoint) / this.widthPerMinute * this.actionObj.interval;\n    } else {\n      this.minDiff = this.widthUptoCursorPoint / this.widthPerMinute * this.actionObj.interval;\n    }\n\n    var startDate = eventObj[this.parent.eventFields.startTime];\n    var startTime = this.parent.activeView.renderDates[0];\n    var startEndHours = util.getStartEndHours(startTime, this.parent.activeView.getStartHour(), this.parent.activeView.getEndHour());\n\n    if (startEndHours.startHour.getTime() > startDate.getTime()) {\n      this.minDiff = this.minDiff + (startEndHours.startHour.getTime() - startDate.getTime()) / util.MS_PER_MINUTE;\n    }\n  };\n\n  DragAndDrop.prototype.dragStop = function (e) {\n    var _this = this;\n\n    this.isCursorAhead = false;\n    this.removeCloneElementClasses();\n    this.removeCloneElement();\n    clearInterval(this.actionObj.navigationInterval);\n    this.actionObj.navigationInterval = null;\n    clearInterval(this.actionObj.scrollInterval);\n    this.actionObj.scrollInterval = null;\n    this.actionClass('removeClass');\n    this.parent.uiStateValues.action = false;\n    this.actionObj.action = null;\n\n    if (this.isAllowDrop(e)) {\n      return;\n    }\n\n    var target = !e.target.classList.contains('e-work-cells') && this.parent.cellTemplate ? closest(e.target, '.e-work-cells') : e.target;\n    var dragArgs = {\n      cancel: false,\n      data: this.getChangedData(this.updatedData),\n      selectedData: this.updatedData,\n      event: e,\n      element: this.actionObj.element,\n      target: target\n    };\n    this.parent.trigger(events.dragStop, dragArgs, function (dragEventArgs) {\n      if (dragEventArgs.cancel) {\n        return;\n      }\n\n      if (_this.parent.activeViewOptions.group.resources.length > 0 && !_this.parent.activeViewOptions.group.allowGroupEdit && !_this.parent.rowAutoHeight && !_this.parent.virtualScrollModule && _this.parent.activeViewOptions.group.byGroupID) {\n        _this.parent.crudModule.crudObj.isCrudAction = true;\n        _this.parent.crudModule.crudObj.sourceEvent = [_this.parent.resourceBase.lastResourceLevel[parseInt(dragArgs.element.getAttribute('data-group-index'), 10)]];\n\n        var currentGroupIndex = parseInt(dragArgs.target.getAttribute('data-group-index'), 10) || _this.actionObj.groupIndex;\n\n        _this.parent.crudModule.crudObj.targetEvent = [_this.parent.resourceBase.lastResourceLevel[currentGroupIndex]];\n      }\n\n      _this.saveChangedData(dragEventArgs, _this.isMultiSelect);\n    });\n    this.updatedData = [];\n    this.multiData = [];\n    this.isMultiSelect = false;\n    this.parent.selectedElements = [];\n  };\n\n  DragAndDrop.prototype.updateNavigatingPosition = function (e) {\n    var _this = this;\n\n    if (this.actionObj.navigation.enable) {\n      var currentDate_1 = this.parent.getCurrentTime();\n\n      if (isNullOrUndefined(this.actionObj.navigationInterval)) {\n        this.actionObj.navigationInterval = window.setInterval(function () {\n          if (currentDate_1) {\n            var crtDate = _this.parent.getCurrentTime();\n\n            var end = crtDate.getSeconds();\n            var start = currentDate_1.getSeconds() + _this.actionObj.navigation.timeDelay / 1000;\n            start = start >= 60 ? start - 60 : start;\n\n            if (start === end) {\n              currentDate_1 = _this.parent.getCurrentTime();\n\n              _this.viewNavigation(e);\n\n              _this.updateDraggingDateTime(e);\n            }\n          }\n        }, this.actionObj.navigation.timeDelay);\n      }\n    }\n  };\n\n  DragAndDrop.prototype.updateDraggingDateTime = function (e) {\n    if (!isNullOrUndefined(this.actionObj.clone.offsetParent) && this.actionObj.clone.offsetParent.classList.contains(cls.MORE_EVENT_POPUP_CLASS)) {\n      this.morePopupEventDragging(e);\n    } else if (this.parent.activeView.isTimelineView() && this.parent.currentView !== 'TimelineYear') {\n      this.timelineEventModule.dateRender = this.parent.activeView.renderDates;\n      this.timelineEventModule.cellWidth = this.actionObj.cellWidth;\n      this.timelineEventModule.getSlotDates();\n      this.actionObj.cellWidth = this.isHeaderRows ? this.timelineEventModule.cellWidth : this.actionObj.cellWidth;\n      this.calculateTimelineTime(e);\n    } else {\n      if (this.parent.currentView === 'Month' || this.parent.currentView === 'TimelineYear') {\n        this.calculateVerticalDate(e);\n      } else {\n        this.calculateVerticalTime(e);\n      }\n    }\n  };\n\n  DragAndDrop.prototype.navigationWrapper = function () {\n    if (!this.parent.activeView.isTimelineView()) {\n      if (this.parent.currentView === 'Month' || !this.parent.timeScale.enable) {\n        var outerWrapperCls = [].slice.call(this.parent.element.querySelectorAll('.' + cls.WORK_CELLS_CLASS));\n        this.actionObj.index = this.parent.activeView.renderDates.length < this.actionObj.index ? this.parent.activeView.renderDates.length - 1 : this.actionObj.index;\n        var targetWrapper = outerWrapperCls[this.actionObj.index].querySelector('.' + cls.APPOINTMENT_WRAPPER_CLASS);\n\n        if (!targetWrapper) {\n          targetWrapper = createElement('div', {\n            className: cls.APPOINTMENT_WRAPPER_CLASS\n          });\n          outerWrapperCls[this.actionObj.index].appendChild(targetWrapper);\n        }\n\n        targetWrapper.appendChild(this.actionObj.clone);\n      } else {\n        var wrapperClass = this.actionObj.clone.classList.contains(cls.ALLDAY_APPOINTMENT_CLASS) ? '.' + cls.ALLDAY_APPOINTMENT_WRAPPER_CLASS : '.' + cls.APPOINTMENT_WRAPPER_CLASS;\n        this.parent.element.querySelectorAll(wrapperClass).item(this.actionObj.index).appendChild(this.actionObj.clone);\n\n        if (wrapperClass === '.' + cls.ALLDAY_APPOINTMENT_WRAPPER_CLASS) {\n          var elementHeight = this.getAllDayEventHeight();\n          var event_2 = [].slice.call(this.parent.element.querySelectorAll('.' + cls.ALLDAY_CELLS_CLASS + ':first-child'));\n\n          if (event_2[0].offsetHeight < elementHeight) {\n            for (var _i = 0, event_1 = event_2; _i < event_1.length; _i++) {\n              var e = event_1[_i];\n              e.style.height = (elementHeight + 2) / 12 + 'em';\n            }\n          }\n\n          this.actionObj.clone.style.height = formatUnit(elementHeight);\n        }\n\n        this.actionObj.height = parseInt(this.actionObj.clone.style.height, 10);\n      }\n    } else {\n      var outWrapper = void 0;\n\n      if (this.parent.activeViewOptions.group.resources.length > 0) {\n        outWrapper = this.parent.element.querySelectorAll('.e-appointment-container:not(.e-hidden)').item(this.actionObj.index);\n      } else {\n        outWrapper = this.parent.element.querySelector('.' + cls.APPOINTMENT_CONTAINER_CLASS);\n      }\n\n      var tarWrapper_1 = outWrapper.querySelector('.' + cls.APPOINTMENT_WRAPPER_CLASS);\n\n      if (!tarWrapper_1) {\n        tarWrapper_1 = createElement('div', {\n          className: cls.APPOINTMENT_WRAPPER_CLASS\n        });\n        outWrapper.appendChild(tarWrapper_1);\n      }\n\n      this.actionObj.cloneElement.forEach(function (ele) {\n        tarWrapper_1.appendChild(ele);\n      });\n    }\n  }; // eslint-disable-next-line @typescript-eslint/no-unused-vars\n\n\n  DragAndDrop.prototype.viewNavigation = function (e) {\n    var navigationType;\n    var dragArea = this.parent.element.querySelector('.' + cls.CONTENT_WRAP_CLASS);\n\n    if (dragArea && (!this.scrollEdges.top && !this.scrollEdges.bottom || closest(this.actionObj.clone, '.' + cls.ALLDAY_APPOINTMENT_WRAPPER_CLASS))) {\n      if (dragArea.scrollLeft === 0 && Math.round(this.actionObj.X) <= Math.round(dragArea.getBoundingClientRect().left + this.actionObj.cellWidth + window.pageXOffset)) {\n        navigationType = this.parent.enableRtl ? 'next' : 'previous';\n      } else if (Math.round(dragArea.scrollLeft) + dragArea.clientWidth === dragArea.scrollWidth && Math.round(this.actionObj.X) >= Math.round(dragArea.getBoundingClientRect().right - this.actionObj.cellWidth + window.pageXOffset)) {\n        navigationType = this.parent.enableRtl ? 'previous' : 'next';\n      }\n\n      if (navigationType) {\n        this.parent.changeDate(this.parent.activeView.getNextPreviousDate(navigationType));\n      }\n    }\n  };\n\n  DragAndDrop.prototype.morePopupEventDragging = function (e) {\n    if (isNullOrUndefined(e.target) || e.target && isNullOrUndefined(closest(e.target, 'td'))) {\n      return;\n    }\n\n    var eventObj = extend({}, this.actionObj.event, null, true);\n    var eventDuration = eventObj[this.parent.eventFields.endTime].getTime() - eventObj[this.parent.eventFields.startTime].getTime();\n    var td = closest(e.target, 'td');\n\n    if (this.parent.currentView === 'TimelineYear' && !td.classList.contains('e-work-cells')) {\n      return;\n    }\n\n    var dragStart = this.parent.getDateFromElement(td);\n    var dragEnd = new Date(dragStart.getTime());\n    dragEnd.setMilliseconds(eventDuration);\n\n    if (this.parent.activeViewOptions.group.resources.length > 0) {\n      this.actionObj.groupIndex = parseInt(td.getAttribute('data-group-index'), 10);\n    }\n\n    this.actionObj.start = new Date(dragStart.getTime());\n    this.actionObj.end = new Date(dragEnd.getTime());\n    this.actionObj.clone.style.top = formatUnit(td.offsetParent.offsetTop);\n    this.actionObj.clone.style.left = formatUnit(td.offsetLeft);\n    this.actionObj.clone.style.width = formatUnit(td.offsetWidth);\n    var eventContainer = td;\n    var eventWrapper;\n\n    if (this.parent.activeView.isTimelineView()) {\n      var rowIndex = closest(td, 'tr').rowIndex;\n      eventContainer = this.parent.element.querySelectorAll('.e-appointment-container').item(rowIndex);\n    }\n\n    eventWrapper = eventContainer.querySelector('.' + cls.APPOINTMENT_WRAPPER_CLASS);\n\n    if (!eventWrapper) {\n      eventWrapper = createElement('div', {\n        className: cls.APPOINTMENT_WRAPPER_CLASS\n      });\n      eventContainer.appendChild(eventWrapper);\n    }\n\n    this.appendCloneElement(eventWrapper);\n  };\n\n  DragAndDrop.prototype.calculateVerticalTime = function (e) {\n    var _this = this;\n\n    if (isNullOrUndefined(this.actionObj.target) || this.actionObj.target && isNullOrUndefined(closest(this.actionObj.target, 'tr')) || !closest(this.actionObj.target, 'td').classList.contains(cls.WORK_CELLS_CLASS) && !closest(this.actionObj.target, 'td').classList.contains(cls.ALLDAY_CELLS_CLASS)) {\n      return;\n    }\n\n    if (this.parent.activeViewOptions.timeScale.enable) {\n      this.swapDragging(e);\n    }\n\n    var dragArea = this.parent.element.querySelector('.' + cls.CONTENT_WRAP_CLASS);\n    var eventObj = extend({}, this.actionObj.event, null, true);\n    var eventStart = eventObj[this.parent.eventFields.startTime];\n    var eventEnd = eventObj[this.parent.eventFields.endTime];\n    var eventDuration = eventEnd.getTime() - eventStart.getTime();\n    var offsetTop = Math.floor(parseInt(this.actionObj.clone.style.top, 10) / this.actionObj.cellHeight) * this.actionObj.cellHeight;\n    offsetTop = offsetTop < 0 ? 0 : offsetTop;\n\n    if (this.scrollEdges.top || this.scrollEdges.bottom) {\n      offsetTop = this.scrollEdges.top ? dragArea.scrollTop - this.heightUptoCursorPoint + this.actionObj.cellHeight + window.pageYOffset : dragArea.scrollTop + dragArea.offsetHeight - this.actionObj.clone.offsetHeight + window.pageYOffset + (this.actionObj.clone.offsetHeight - this.heightUptoCursorPoint);\n      offsetTop = Math.round(offsetTop / this.actionObj.cellHeight) * this.actionObj.cellHeight;\n      this.actionObj.clone.style.top = formatUnit(offsetTop);\n    }\n\n    var rowIndex = this.parent.activeViewOptions.timeScale.enable ? offsetTop / this.actionObj.cellHeight : 0;\n    var heightPerMinute = this.actionObj.cellHeight / this.actionObj.slotInterval;\n    var diffInMinutes = parseInt(this.actionObj.clone.style.top, 10) - offsetTop;\n    var tr;\n\n    if (this.isAllDayDrag) {\n      tr = this.parent.element.querySelector('.' + cls.ALLDAY_ROW_CLASS);\n    } else {\n      var trCollections = [].slice.call(this.parent.getContentTable().querySelectorAll('tr'));\n      tr = trCollections[rowIndex];\n    }\n\n    var index;\n\n    if (closest(this.actionObj.target, 'td').classList.contains(cls.WORK_CELLS_CLASS) || closest(this.actionObj.target, 'td').classList.contains(cls.ALLDAY_CELLS_CLASS)) {\n      index = closest(this.actionObj.target, 'td').cellIndex;\n    }\n\n    var colIndex = isNullOrUndefined(index) ? closest(this.actionObj.clone, 'td').cellIndex : index;\n    this.actionObj.index = colIndex;\n\n    if (isNullOrUndefined(tr)) {\n      return;\n    }\n\n    var td = tr.children[colIndex];\n\n    if (this.parent.activeViewOptions.group.resources.length > 0) {\n      this.actionObj.groupIndex = parseInt(td.getAttribute('data-group-index'), 10);\n    }\n\n    var dragStart;\n    var dragEnd;\n\n    if (this.parent.activeViewOptions.timeScale.enable && !this.isAllDayDrag) {\n      this.appendCloneElement(this.getEventWrapper(colIndex));\n      dragStart = this.parent.getDateFromElement(td);\n      dragStart.setMinutes(dragStart.getMinutes() + diffInMinutes / heightPerMinute);\n      dragEnd = new Date(dragStart.getTime());\n\n      if (this.actionObj.element.classList.contains(cls.ALLDAY_APPOINTMENT_CLASS)) {\n        dragEnd.setMinutes(dragEnd.getMinutes() + this.actionObj.slotInterval);\n      } else {\n        dragEnd.setMilliseconds(eventDuration);\n      }\n    } else {\n      dragStart = this.parent.getDateFromElement(td);\n      dragStart.setDate(dragStart.getDate() - this.daysVariation);\n      dragStart.setHours(eventStart.getHours(), eventStart.getMinutes(), eventStart.getSeconds());\n      dragEnd = new Date(dragStart.getTime());\n      dragEnd.setMilliseconds(eventDuration);\n\n      if (!this.actionObj.element.classList.contains(cls.ALLDAY_APPOINTMENT_CLASS) && this.actionObj.clone.classList.contains(cls.ALLDAY_APPOINTMENT_CLASS)) {\n        dragEnd = util.addDays(util.resetTime(dragEnd), 1);\n      }\n\n      this.updateAllDayEvents(dragStart, dragEnd, this.parent.activeViewOptions.group.byDate ? colIndex : undefined);\n    }\n\n    this.actionObj.start = new Date(+dragStart);\n    this.actionObj.end = new Date(+dragEnd);\n    var event = this.getUpdatedEvent(this.actionObj.start, this.actionObj.end, this.actionObj.event);\n    var dynamicWrappers = [].slice.call(this.parent.element.querySelectorAll('.e-dynamic-clone'));\n\n    for (var _i = 0, dynamicWrappers_1 = dynamicWrappers; _i < dynamicWrappers_1.length; _i++) {\n      var wrapper = dynamicWrappers_1[_i];\n      remove(wrapper);\n    }\n\n    if (this.multiData.length > 0) {\n      if (this.isAllDayTarget && this.isAllDayDrag && !isNullOrUndefined(this.actionObj.isAllDay) && !this.actionObj.isAllDay) {\n        var targetCellTime_1 = parseInt(closest(this.actionObj.target, 'td').getAttribute('data-date'), 10);\n        this.multiData.forEach(function (data) {\n          _this.swagData.push(extend({}, data, null, true));\n\n          if (data[_this.parent.eventFields.isAllDay]) {\n            data[_this.parent.eventFields.startTime] = new Date(data[_this.parent.eventFields.startTime].getTime() + (targetCellTime_1 - _this.startTime));\n            var startTime = new Date(data[_this.parent.eventFields.startTime]);\n            var endTime = new Date(startTime.setMinutes(startTime.getMinutes() + _this.actionObj.slotInterval));\n            data[_this.parent.eventFields.endTime] = endTime;\n            data[_this.parent.eventFields.isAllDay] = false;\n          }\n        });\n        this.startTime = targetCellTime_1;\n      }\n\n      if (this.isAllDayTarget && this.isAllDayDrag && !isNullOrUndefined(this.actionObj.isAllDay) && this.actionObj.isAllDay && this.swagData.length > 0) {\n        this.multiData = this.swagData;\n        this.swagData = [];\n        var eventObj_1 = extend({}, this.actionObj.event, null, true);\n        this.startTime = eventObj_1[this.parent.eventFields.startTime].getTime();\n      }\n\n      var startTimeDiff = event[this.parent.eventFields.startTime].getTime() - this.startTime;\n\n      for (var index_1 = 0; index_1 < this.multiData.length; index_1++) {\n        this.updatedData[index_1] = this.updateMultipleData(this.multiData[index_1], startTimeDiff);\n        var dayIndex = this.getDayIndex(this.updatedData[index_1]);\n\n        if (dayIndex >= 0) {\n          var wrapper = this.getEventWrapper(dayIndex, this.updatedData[index_1][this.parent.eventFields.isAllDay]);\n          this.appendCloneElement(wrapper, this.actionObj.cloneElement[index_1]);\n          this.updateEventHeight(this.updatedData[index_1], index_1, dayIndex);\n        } else {\n          if (!isNullOrUndefined(this.actionObj.cloneElement[index_1].parentNode)) {\n            remove(this.actionObj.cloneElement[index_1]);\n          }\n        }\n      }\n    } else {\n      this.updateEventHeight(event);\n    }\n\n    this.updateTimePosition(this.actionObj.start, this.updatedData);\n  };\n\n  DragAndDrop.prototype.splitEvent = function (event) {\n    var eventFields = this.parent.eventFields;\n    var eventData = [];\n    var startTime = event[eventFields.startTime];\n    var endTime = event[eventFields.endTime];\n    var isDifferentDate = util.resetTime(new Date(startTime.getTime())) < util.resetTime(new Date(endTime.getTime()));\n\n    if (isDifferentDate) {\n      var scheduleStartHour = this.parent.activeView.getStartHour();\n      var scheduleEndHour = this.parent.activeView.getEndHour();\n      var startDate = util.getStartEndHours(util.resetTime(startTime), scheduleStartHour, scheduleEndHour);\n      var endDate = util.getStartEndHours(util.resetTime(endTime), scheduleStartHour, scheduleEndHour);\n      var firstEventObj = extend({}, event, null, true);\n      firstEventObj[eventFields.endTime] = startDate.endHour;\n      eventData.push(firstEventObj);\n      var secondEventObj = extend({}, event, null, true);\n      secondEventObj[eventFields.startTime] = endDate.startHour;\n      eventData.push(secondEventObj);\n    } else {\n      eventData.push(event);\n    }\n\n    return eventData;\n  };\n\n  DragAndDrop.prototype.updateMultipleData = function (data, timeDifference) {\n    var eventObj = extend({}, data, null, true);\n\n    if (!isNullOrUndefined(this.actionObj.isAllDay) && this.parent.activeViewOptions.timeScale.enable && (this.isAllDayTarget && eventObj[this.parent.eventFields.isAllDay] || !this.isAllDayTarget && !eventObj[this.parent.eventFields.isAllDay])) {\n      eventObj[this.parent.eventFields.isAllDay] = this.actionObj.isAllDay;\n    }\n\n    var endTimeDiff = eventObj[this.parent.eventFields.endTime].getTime() - eventObj[this.parent.eventFields.startTime].getTime();\n\n    if (eventObj[this.parent.eventFields.isAllDay]) {\n      var differInDays = Math.ceil(timeDifference / (1000 * 3600 * 24));\n      var day = Math.ceil(endTimeDiff / (1000 * 3600 * 24));\n      var startTime = new Date(eventObj[this.parent.eventFields.startTime]);\n      eventObj[this.parent.eventFields.startTime] = util.resetTime(new Date(startTime.setDate(startTime.getDate() + differInDays)));\n      eventObj[this.parent.eventFields.endTime] = util.addDays(eventObj[this.parent.eventFields.startTime], day);\n    } else {\n      eventObj[this.parent.eventFields.startTime] = new Date(eventObj[this.parent.eventFields.startTime].getTime() + timeDifference);\n      eventObj[this.parent.eventFields.endTime] = new Date(eventObj[this.parent.eventFields.startTime].getTime() + endTimeDiff);\n    }\n\n    return eventObj;\n  };\n\n  DragAndDrop.prototype.getDayIndex = function (event) {\n    var eventObj = extend({}, event, null, true);\n    var startTime = util.resetTime(eventObj[this.parent.eventFields.startTime]).getTime();\n    var query = '';\n    var wrapper = cls.DAY_WRAPPER_CLASS;\n\n    if (this.parent.activeViewOptions.timeScale.enable && eventObj[this.parent.eventFields.isAllDay]) {\n      wrapper = cls.ALLDAY_APPOINTMENT_WRAPPER_CLASS;\n    } else {\n      wrapper = cls.WORK_CELLS_CLASS;\n    }\n\n    query = '.' + wrapper + '[data-date=\"' + startTime + '\"]';\n\n    if (this.parent.activeViewOptions.group.resources.length > 0) {\n      query = query + '[data-group-index=\"' + this.actionObj.groupIndex + '\"]';\n    }\n\n    this.targetTd = this.parent.element.querySelector(query);\n\n    if (isNullOrUndefined(this.targetTd)) {\n      return -1;\n    }\n\n    return this.targetTd.cellIndex;\n  };\n\n  DragAndDrop.prototype.updateEventHeight = function (event, index, colIndex) {\n    this.verticalEvent.initializeValues();\n    var datesCount = 0;\n\n    if (!this.parent.uiStateValues.isGroupAdaptive) {\n      for (var i = 0; i < this.actionObj.groupIndex; i++) {\n        datesCount = datesCount + this.verticalEvent.dateRender[i].length;\n      }\n    }\n\n    var indexGroup = this.parent.uiStateValues.isGroupAdaptive ? datesCount : this.actionObj.groupIndex;\n    var target = this.parent.activeViewOptions.group.byDate && !isNullOrUndefined(this.parent.getDateFromElement(this.actionObj.target)) ? true : false;\n\n    if (target || !this.parent.activeViewOptions.group.byDate) {\n      var dynamicIndex = -1;\n      var dayIndex = !this.parent.activeViewOptions.group.byDate ? isNullOrUndefined(index) ? this.actionObj.index - datesCount : colIndex - datesCount : this.parent.getIndexOfDate(this.verticalEvent.dateRender[indexGroup], util.resetTime( // eslint-disable-next-line max-len\n      this.parent.getDateFromElement(isNullOrUndefined(index) ? this.actionObj.target : this.targetTd)));\n      var splitEvents = this.splitEvent(event);\n      var events_1 = event[this.parent.eventFields.isAllDay] || this.parent.eventBase.isAllDayAppointment(event) || splitEvents.length > 2 ? [event] : splitEvents;\n\n      for (var i = 0; i < events_1.length; i++) {\n        if (i > 0) {\n          var filterQuery = \".e-day-wrapper[data-date=\\\"\" + util.resetTime(events_1[i][this.parent.eventFields.startTime]).getTime() + \"\\\"]\";\n\n          if (this.parent.activeViewOptions.group.resources.length > 0) {\n            filterQuery = filterQuery.concat('[data-group-index = \"' + this.actionObj.groupIndex + '\"]');\n          }\n\n          var appWrap = this.parent.element.querySelector(filterQuery);\n\n          if (appWrap) {\n            dayIndex = dayIndex + 1;\n            dynamicIndex = appWrap.cellIndex;\n          } else {\n            dayIndex = -1;\n          }\n        }\n\n        if (dayIndex >= 0) {\n          var record = this.verticalEvent.isSpannedEvent(events_1[i], dayIndex, indexGroup);\n          var eStart = record[this.verticalEvent.fields.startTime];\n          var eEnd = record[this.verticalEvent.fields.endTime];\n          var appHeight = this.parent.activeViewOptions.timeScale.enable ? this.verticalEvent.getHeight(eStart, eEnd) : this.actionObj.element.offsetHeight;\n          var topValue = this.parent.activeViewOptions.timeScale.enable ? this.verticalEvent.getTopValue(eStart, dayIndex, indexGroup) : this.actionObj.element.offsetTop;\n\n          if (isNullOrUndefined(index)) {\n            if (i === 0) {\n              this.actionObj.clone.style.top = formatUnit(topValue);\n              this.actionObj.clone.style.height = formatUnit(appHeight);\n            } else {\n              this.renderSpannedEvents(record, dynamicIndex, topValue, appHeight);\n            }\n          } else {\n            var appWidth = this.actionObj.cellWidth;\n\n            if (event[this.parent.eventFields.isAllDay]) {\n              topValue = this.parent.element.querySelector('.' + cls.ALLDAY_ROW_CLASS).offsetTop;\n              appHeight = this.getAllDayEventHeight();\n              var timeDiff = event[this.parent.eventFields.endTime].getTime() - event[this.parent.eventFields.startTime].getTime();\n              var allDayDifference = Math.ceil(timeDiff / (1000 * 3600 * 24));\n\n              if (allDayDifference >= 0) {\n                appWidth = allDayDifference * this.actionObj.cellWidth;\n              }\n            }\n\n            if (this.actionObj.cloneElement[index]) {\n              if (i === 0) {\n                this.actionObj.cloneElement[index].style.top = formatUnit(topValue);\n                this.actionObj.cloneElement[index].style.height = formatUnit(appHeight);\n                this.actionObj.cloneElement[index].style.width = formatUnit(appWidth);\n                this.actionObj.cloneElement[index].style.left = formatUnit(0);\n              } else {\n                this.renderSpannedEvents(record, dynamicIndex, topValue, appHeight);\n              }\n            }\n          }\n        }\n      }\n    }\n  };\n\n  DragAndDrop.prototype.renderSpannedEvents = function (record, index, top, height) {\n    var startTime = record[this.parent.eventFields.startTime].getTime();\n    var endTime = record[this.parent.eventFields.endTime].getTime();\n\n    if (startTime !== endTime) {\n      var appointmentElement = this.verticalEvent.createAppointmentElement(record, false, record.isSpanned, this.actionObj.groupIndex);\n      addClass([appointmentElement], [cls.CLONE_ELEMENT_CLASS, 'e-dynamic-clone']);\n      setStyleAttribute(appointmentElement, {\n        'width': '100%',\n        'height': height + 'px',\n        'top': top + 'px',\n        'border': '0px'\n      });\n      var appointmentWrap = [].slice.call(this.parent.element.querySelectorAll('.' + cls.APPOINTMENT_WRAPPER_CLASS));\n      appointmentWrap[index].appendChild(appointmentElement);\n    }\n  };\n\n  DragAndDrop.prototype.getRenderedDates = function () {\n    var _this = this;\n\n    var _a, _b;\n\n    var renderDates = this.parent.activeView.renderDates;\n\n    (_a = this.parent.eventBase.slots).push.apply(_a, this.parent.activeView.renderDates.map(function (date) {\n      return +date;\n    }));\n\n    if (this.parent.activeViewOptions.group.resources.length > 0) {\n      this.parent.eventBase.slots = [];\n      var resources = this.parent.resourceBase.lastResourceLevel.filter(function (res) {\n        return res.groupIndex === _this.actionObj.groupIndex;\n      });\n      renderDates = resources[0].renderDates;\n\n      (_b = this.parent.eventBase.slots).push.apply(_b, renderDates.map(function (date) {\n        return +date;\n      }));\n    }\n\n    return renderDates;\n  };\n\n  DragAndDrop.prototype.updateAllDayEvents = function (startDate, endDate, colIndex) {\n    this.parent.eventBase.slots = [];\n    var event = this.getUpdatedEvent(startDate, endDate, this.actionObj.event);\n    var renderDates = this.getRenderedDates();\n    var events = this.parent.eventBase.splitEvent(event, renderDates);\n    var query = \".e-all-day-cells[data-date=\\\"\" + events[0][this.parent.eventFields.startTime].getTime() + \"\\\"]\";\n\n    if (this.parent.activeViewOptions.group.resources.length > 0) {\n      query = query.concat('[data-group-index = \"' + this.actionObj.groupIndex + '\"]');\n    }\n\n    var cell = [].slice.call(this.parent.element.querySelectorAll(query));\n\n    if (cell.length > 0 || !isNullOrUndefined(colIndex)) {\n      var cellIndex = !isNullOrUndefined(colIndex) ? colIndex : cell[0].cellIndex;\n      this.appendCloneElement(this.getEventWrapper(cellIndex)); // eslint-disable-next-line max-len\n\n      this.actionObj.clone.style.width = formatUnit(events[0].data.count * this.actionObj.cellWidth);\n    }\n  }; // eslint-disable-next-line @typescript-eslint/no-unused-vars\n\n\n  DragAndDrop.prototype.swapDragging = function (e) {\n    var colIndex = closest(this.actionObj.target, 'td').cellIndex;\n\n    if (closest(this.actionObj.target, '.' + cls.DATE_HEADER_WRAP_CLASS) && !closest(this.actionObj.clone, '.' + cls.ALLDAY_APPOINTMENT_WRAPPER_CLASS)) {\n      addClass([this.actionObj.clone], cls.ALLDAY_APPOINTMENT_CLASS);\n      this.appendCloneElement(this.getEventWrapper(colIndex));\n      this.actionObj.isAllDay = true;\n      var eventHeight = this.getAllDayEventHeight();\n      var allDayElement = [].slice.call(this.parent.element.querySelectorAll('.' + cls.ALLDAY_CELLS_CLASS + ':first-child'));\n\n      if (allDayElement[0].offsetHeight < eventHeight) {\n        for (var _i = 0, allDayElement_1 = allDayElement; _i < allDayElement_1.length; _i++) {\n          var element = allDayElement_1[_i];\n          element.style.height = (eventHeight + 2) / 12 + 'em';\n        }\n      }\n\n      setStyleAttribute(this.actionObj.clone, {\n        width: formatUnit(this.actionObj.cellWidth),\n        height: formatUnit(eventHeight),\n        top: formatUnit(this.parent.element.querySelector('.' + cls.ALLDAY_ROW_CLASS).offsetTop)\n      });\n    }\n\n    if (closest(this.actionObj.target, '.' + cls.WORK_CELLS_CLASS) && !closest(this.actionObj.clone, '.' + cls.DAY_WRAPPER_CLASS)) {\n      removeClass([this.actionObj.clone], cls.ALLDAY_APPOINTMENT_CLASS);\n      this.appendCloneElement(this.getEventWrapper(colIndex));\n      this.actionObj.isAllDay = false; // eslint-disable-next-line max-len\n\n      var height = this.actionObj.element.offsetHeight === 0 ? this.actionObj.height : this.actionObj.element.offsetHeight;\n      setStyleAttribute(this.actionObj.clone, {\n        left: formatUnit(0),\n        height: formatUnit(height),\n        width: formatUnit(this.actionObj.cellWidth)\n      });\n    }\n  };\n\n  DragAndDrop.prototype.calculateVerticalDate = function (e) {\n    if (isNullOrUndefined(e.target) || e.target && isNullOrUndefined(closest(e.target, 'tr')) || e.target && e.target.tagName === 'DIV') {\n      return;\n    }\n\n    var eventObj = extend({}, this.actionObj.event, null, true);\n\n    if (isNullOrUndefined(this.parent.eventDragArea)) {\n      this.removeCloneElement();\n    }\n\n    var eventDuration = eventObj[this.parent.eventFields.endTime].getTime() - eventObj[this.parent.eventFields.startTime].getTime();\n    var td = closest(this.actionObj.target, 'td');\n\n    if (!isNullOrUndefined(td)) {\n      var tr = td.parentElement;\n      this.actionObj.index = tr.rowIndex * tr.children.length + td.cellIndex;\n      var workCells = [].slice.call(this.parent.element.querySelectorAll('.' + cls.WORK_CELLS_CLASS));\n      td = workCells[this.actionObj.index];\n      var currentDate = this.parent.getDateFromElement(td);\n\n      if (!isNullOrUndefined(currentDate)) {\n        if (this.parent.activeViewOptions.group.resources.length > 0) {\n          this.actionObj.groupIndex = parseInt(td.getAttribute('data-group-index'), 10);\n        }\n\n        var timeString = new Date(currentDate.setDate(currentDate.getDate() - this.daysVariation));\n        var dragStart = new Date(timeString.getTime());\n        var dragEnd = new Date(dragStart.getTime());\n        var startTimeDiff = eventObj[this.parent.eventFields.startTime].getTime() - util.resetTime(new Date(+eventObj[this.parent.eventFields.startTime])).getTime();\n        dragStart = new Date(dragStart.getTime() + startTimeDiff);\n        dragEnd = new Date(dragStart.getTime() + eventDuration);\n        this.actionObj.start = new Date(dragStart.getTime());\n        this.actionObj.end = new Date(dragEnd.getTime());\n      }\n    }\n\n    var event = this.getUpdatedEvent(this.actionObj.start, this.actionObj.end, this.actionObj.event);\n    var eventWrappers = [].slice.call(this.parent.element.querySelectorAll('.' + cls.CLONE_ELEMENT_CLASS));\n\n    for (var _i = 0, eventWrappers_1 = eventWrappers; _i < eventWrappers_1.length; _i++) {\n      var wrapper = eventWrappers_1[_i];\n      remove(wrapper);\n    }\n\n    if (this.multiData && this.multiData.length > 0) {\n      var startTime = util.resetTime(new Date(event[this.parent.eventFields.startTime]));\n      var startTimeDiff = startTime.getTime() - this.startTime;\n\n      if (this.parent.currentView === 'TimelineYear' && this.parent.group.resources.length > 0) {\n        startTimeDiff = (startTime.getFullYear() - new Date(this.startTime).getFullYear()) * 12;\n        startTimeDiff -= new Date(this.startTime).getMonth();\n        startTimeDiff += startTime.getMonth();\n      }\n\n      for (var index = 0; index < this.multiData.length; index++) {\n        this.updatedData[index] = this.updateMultipleVerticalDate(this.multiData[index], startTimeDiff);\n\n        if (this.parent.currentView === 'TimelineYear') {\n          this.dynamicYearlyEventsRendering(this.updatedData[index]);\n        } else {\n          this.dynamicEventsRendering(this.updatedData[index]);\n        }\n      }\n    } else {\n      if (this.parent.currentView === 'TimelineYear') {\n        this.dynamicYearlyEventsRendering(event);\n      } else {\n        this.dynamicEventsRendering(event);\n      }\n    }\n  };\n\n  DragAndDrop.prototype.updateMultipleVerticalDate = function (data, timeDifference) {\n    var eventObj = extend({}, data, null, true);\n    var eventDuration = eventObj[this.parent.eventFields.endTime].getTime() - eventObj[this.parent.eventFields.startTime].getTime();\n    var startDate = new Date(eventObj[this.parent.eventFields.startTime]);\n\n    if (this.parent.currentView === 'TimelineYear' && this.parent.group.resources.length > 0) {\n      eventObj[this.parent.eventFields.startTime] = new Date(startDate.setMonth(startDate.getMonth() + timeDifference));\n    } else {\n      var differInDays = Math.ceil(timeDifference / util.MS_PER_DAY);\n      eventObj[this.parent.eventFields.startTime] = new Date(startDate.setDate(startDate.getDate() + differInDays));\n    }\n\n    eventObj[this.parent.eventFields.endTime] = new Date(eventObj[this.parent.eventFields.startTime].getTime() + eventDuration);\n    return eventObj;\n  };\n\n  DragAndDrop.prototype.calculateTimelineTime = function (e) {\n    var eventObj = extend({}, this.actionObj.event, null, true);\n    var eventDuration = eventObj[this.parent.eventFields.endTime].getTime() - eventObj[this.parent.eventFields.startTime].getTime();\n    var offsetLeft = this.parent.enableRtl ? Math.abs(this.actionObj.clone.offsetLeft) - this.actionObj.clone.offsetWidth : parseInt(this.actionObj.clone.style.left, 10);\n    offsetLeft = Math.floor(offsetLeft / this.actionObj.cellWidth) * this.actionObj.cellWidth;\n    var rightOffset;\n\n    if (this.parent.enableRtl) {\n      rightOffset = Math.abs(parseInt(this.actionObj.clone.style.right, 10));\n      this.actionObj.clone.style.right = formatUnit(rightOffset);\n    }\n\n    offsetLeft = this.getOffsetValue(offsetLeft, rightOffset);\n    var colIndex = this.getColumnIndex(offsetLeft);\n    var dragArea = this.parent.element.querySelector('.' + cls.CONTENT_WRAP_CLASS);\n    var contentWrapRight = dragArea.getBoundingClientRect().right;\n    var cursorDrag = this.parent.activeView.isTimelineView() && !this.parent.enableRtl && this.actionObj.pageX > this.actionObj.clone.getBoundingClientRect().right && !this.isMorePopupOpened && !(this.actionObj.pageX > contentWrapRight);\n    var leftVal = this.parent.eventDragArea ? dragArea.scrollLeft - dragArea.offsetLeft : 0;\n\n    if ((this.isCursorAhead || cursorDrag) && !this.isStepDragging) {\n      this.isCursorAhead = true;\n    }\n\n    var cloneIndex = Math.floor((this.actionObj.pageX - this.actionObj.clone.getBoundingClientRect().left + leftVal) / this.actionObj.cellWidth);\n\n    if (this.parent.enableRtl) {\n      cloneIndex = Math.abs(Math.floor((this.actionObj.pageX - this.actionObj.clone.getBoundingClientRect().right) / this.actionObj.cellWidth)) - 1;\n    }\n\n    if (this.cursorPointIndex < 0) {\n      this.cursorIndex(e, eventObj, offsetLeft, cloneIndex);\n    }\n\n    var tr = this.parent.getContentTable().querySelector('tr');\n    var index = this.getCursorCurrentIndex(colIndex, cloneIndex, tr);\n    index = index < 0 ? 0 : index;\n    var eventStart = this.isHeaderRows ? new Date(this.timelineEventModule.dateRender[index].getTime()) : this.parent.getDateFromElement(tr.children[index]);\n\n    if (this.isStepDragging) {\n      var widthDiff = this.getWidthDiff(tr, index);\n\n      if (widthDiff !== 0) {\n        var timeDiff = Math.round(widthDiff / this.widthPerMinute);\n        eventStart.setMinutes(eventStart.getMinutes() + timeDiff * this.actionObj.interval);\n\n        if (this.isCursorAhead || cursorDrag) {\n          eventStart.setMilliseconds(-eventDuration);\n        } else {\n          eventStart.setMinutes(eventStart.getMinutes() - this.minDiff);\n        }\n      } else {\n        eventStart = this.actionObj.start;\n      }\n    } else {\n      if (this.isCursorAhead || cursorDrag) {\n        eventStart.setMinutes(eventStart.getMinutes() + (this.isTimelineDayProcess ? MINUTES_PER_DAY : this.actionObj.slotInterval));\n        eventStart.setMilliseconds(-eventDuration);\n      } else {\n        eventStart.setMinutes(eventStart.getMinutes() - this.cursorPointIndex * (this.isTimelineDayProcess ? MINUTES_PER_DAY : this.actionObj.slotInterval));\n      }\n    }\n\n    eventStart = this.calculateIntervalTime(eventStart);\n\n    if (this.isTimelineDayProcess) {\n      var eventSrt = eventObj[this.parent.eventFields.startTime];\n      eventStart.setHours(eventSrt.getHours(), eventSrt.getMinutes(), eventSrt.getSeconds());\n    }\n\n    var eventEnd = new Date(eventStart.getTime());\n    eventEnd.setMilliseconds(eventDuration);\n    var eventsData = [this.getUpdatedEvent(eventStart, eventEnd, this.actionObj.event)];\n\n    if (this.multiData.length > 0) {\n      var startTimeDiff = eventsData[0][this.parent.eventFields.startTime].getTime() - this.startTime;\n\n      for (var i = 0; i < this.multiData.length; i++) {\n        this.updatedData[i] = this.updateMultipleData(this.multiData[i], startTimeDiff);\n      }\n\n      eventsData = this.updatedData;\n    }\n\n    for (var dataIndex = 0; dataIndex < eventsData.length; dataIndex++) {\n      var events_2 = this.timelineEventModule.splitEvent(eventsData[dataIndex], this.timelineEventModule.dateRender);\n      var eventData = events_2[0].data;\n      var startTime = this.timelineEventModule.getStartTime(events_2[0], eventData);\n      var endTime = this.timelineEventModule.getEndTime(events_2[0], eventData); // eslint-disable-next-line max-len\n\n      var width = this.timelineEventModule.getEventWidth(startTime, endTime, eventObj[this.parent.eventFields.isAllDay], eventData.count); // eslint-disable-next-line max-len\n\n      var day = this.parent.getIndexOfDate(this.timelineEventModule.dateRender, util.resetTime(new Date(startTime.getTime())));\n      day = day < 0 ? 0 : day;\n      var left = this.timelineEventModule.getPosition(startTime, endTime, eventObj[this.parent.eventFields.isAllDay], day);\n      var cloneElement = this.multiData.length > 0 ? this.actionObj.cloneElement[dataIndex] : this.actionObj.clone;\n\n      if (this.parent.enableRtl) {\n        cloneElement.style.right = formatUnit(left);\n      } else {\n        cloneElement.style.left = formatUnit(left);\n      }\n\n      if (!this.isMorePopupOpened) {\n        cloneElement.style.width = formatUnit(width);\n      }\n\n      if (this.parent.activeViewOptions.group.resources.length > 0) {\n        this.calculateResourceGroupingPosition(e, cloneElement);\n      }\n\n      this.actionObj.start = new Date(eventStart.getTime());\n      this.actionObj.end = new Date(eventEnd.getTime());\n      this.updateTimePosition(this.actionObj.start, this.updatedData);\n    }\n  };\n\n  DragAndDrop.prototype.getOffsetValue = function (offsetLeft, rightOffset) {\n    if (this.scrollEdges.left || this.scrollEdges.right) {\n      var viewEle = this.parent.element.querySelector('.' + cls.CONTENT_WRAP_CLASS);\n\n      if (this.parent.enableRtl) {\n        rightOffset = viewEle.offsetWidth - viewEle.scrollLeft;\n\n        if (this.scrollEdges.right) {\n          rightOffset = rightOffset - viewEle.offsetWidth + this.actionObj.clone.offsetWidth - (this.actionObj.clone.offsetWidth - this.widthUptoCursorPoint);\n        } else {\n          rightOffset = rightOffset + this.widthUptoCursorPoint;\n\n          if (rightOffset - this.widthUptoCursorPoint >= viewEle.scrollWidth) {\n            this.actionObj.clone.style.width = formatUnit(this.actionObj.clone.offsetWidth - this.widthUptoCursorPoint + this.actionObj.cellWidth);\n            rightOffset = viewEle.scrollLeft - viewEle.scrollWidth;\n          }\n        }\n\n        this.actionObj.clone.style.left = formatUnit(rightOffset);\n      } else {\n        if (this.scrollEdges.left) {\n          offsetLeft = viewEle.scrollLeft - this.widthUptoCursorPoint + this.actionObj.cellWidth;\n\n          if (viewEle.scrollLeft + viewEle.offsetWidth >= viewEle.offsetWidth) {\n            viewEle.scrollLeft = viewEle.scrollLeft - 1;\n          } else if (this.actionObj.clone.offsetLeft === 0) {\n            offsetLeft = viewEle.scrollLeft;\n          }\n        } else {\n          offsetLeft = viewEle.scrollLeft + viewEle.offsetWidth - this.actionObj.clone.offsetWidth + (this.actionObj.clone.offsetWidth - this.widthUptoCursorPoint);\n        }\n\n        offsetLeft = offsetLeft < 0 ? 0 : offsetLeft;\n        this.actionObj.clone.style.left = formatUnit(offsetLeft);\n      }\n    }\n\n    return offsetLeft;\n  };\n\n  DragAndDrop.prototype.getWidthDiff = function (tr, index) {\n    var pages = this.scrollArgs.element.getBoundingClientRect();\n\n    if (pages.left <= this.actionObj.pageX && pages.right >= this.actionObj.pageX) {\n      var targetLeft = tr.children[index].offsetLeft;\n      var pageX = this.actionObj.pageX - pages.left;\n\n      if (this.parent.enableRtl) {\n        return targetLeft + this.actionObj.cellWidth - (this.scrollArgs.element.scrollLeft + pageX);\n      } else {\n        return this.scrollArgs.element.scrollLeft + pageX - targetLeft;\n      }\n    }\n\n    return 0;\n  };\n\n  DragAndDrop.prototype.getColumnIndex = function (offsetLeft) {\n    var index = Math.floor(offsetLeft / this.actionObj.cellWidth);\n\n    if (this.isHeaderRows) {\n      return index;\n    }\n\n    return this.getIndex(index);\n  };\n\n  DragAndDrop.prototype.getCursorCurrentIndex = function (colIndex, cloneIndex, tr) {\n    var index = colIndex + cloneIndex;\n\n    if (this.isHeaderRows) {\n      var dateLength = Math.floor(tr.offsetWidth / this.actionObj.cellWidth);\n      return index > dateLength - 1 ? dateLength - 1 : index;\n    }\n\n    return index > tr.children.length - 1 ? tr.children.length - 1 : index;\n  };\n\n  DragAndDrop.prototype.cursorIndex = function (e, event, left, index) {\n    var td = closest(e.target, '.e-work-cells');\n\n    if (!isNullOrUndefined(td) && !this.isMorePopupOpened) {\n      var targetDate = this.parent.getDateFromElement(td);\n\n      if (this.isHeaderRows) {\n        var currentIndex = Math.floor(left / this.actionObj.cellWidth);\n        targetDate = new Date(this.timelineEventModule.dateRender[currentIndex + index].getTime());\n      }\n\n      var timeDiff = targetDate.getTime() - event[this.parent.eventFields.startTime].getTime();\n\n      if (this.isTimelineDayProcess) {\n        this.cursorPointIndex = Math.abs(Math.ceil(timeDiff / util.MS_PER_DAY));\n      } else {\n        var widthDiff = Math.floor(timeDiff / util.MS_PER_MINUTE / (this.actionObj.slotInterval / this.actionObj.cellWidth));\n        this.cursorPointIndex = Math.floor(widthDiff / this.actionObj.cellWidth);\n        this.cursorPointIndex = this.cursorPointIndex < 0 ? 0 : this.cursorPointIndex;\n      }\n    } else {\n      this.cursorPointIndex = 0;\n    }\n  };\n\n  DragAndDrop.prototype.calculateResourceGroupingPosition = function (e, cloneElement) {\n    var dragArea = this.parent.element.querySelector('.' + cls.CONTENT_WRAP_CLASS);\n    var trCollection = [].slice.call(this.parent.element.querySelectorAll('.e-content-wrap .e-content-table tr:not(.e-hidden)'));\n    var translateY = util.getTranslateY(dragArea.querySelector('table'));\n    translateY = isNullOrUndefined(translateY) ? 0 : translateY;\n    var rowHeight = this.parent.rowAutoHeight ? ~~(dragArea.querySelector('table').offsetHeight / trCollection.length) : this.actionObj.cellHeight;\n    var rowIndex = Math.floor(Math.floor(this.actionObj.Y + (dragArea.scrollTop - translateY - (window.scrollY || window.pageYOffset)) - dragArea.getBoundingClientRect().top) / rowHeight);\n    rowIndex = rowIndex < 0 ? 0 : rowIndex > trCollection.length - 1 ? trCollection.length - 1 : rowIndex;\n    this.actionObj.index = rowIndex;\n    var eventContainer = this.parent.element.querySelectorAll('.e-appointment-container:not(.e-hidden)').item(rowIndex);\n    var eventWrapper = eventContainer.querySelector('.' + cls.APPOINTMENT_WRAPPER_CLASS);\n\n    if (!eventWrapper) {\n      eventWrapper = createElement('div', {\n        className: cls.APPOINTMENT_WRAPPER_CLASS\n      });\n      eventContainer.appendChild(eventWrapper);\n    }\n\n    this.appendCloneElement(eventWrapper, cloneElement);\n    var td = closest(this.actionObj.target, 'td');\n    this.actionObj.groupIndex = td && !isNaN(parseInt(td.getAttribute('data-group-index'), 10)) ? parseInt(td.getAttribute('data-group-index'), 10) : this.actionObj.groupIndex;\n    var top = trCollection[rowIndex].getBoundingClientRect().height * rowIndex;\n\n    if (this.parent.rowAutoHeight) {\n      var cursorElement = this.getCursorElement(e);\n\n      if (cursorElement) {\n        top = cursorElement.classList.contains(cls.WORK_CELLS_CLASS) ? cursorElement.offsetTop : cursorElement.offsetParent.classList.contains(cls.APPOINTMENT_CLASS) ? cursorElement.offsetParent.offsetTop : top;\n      }\n    }\n\n    cloneElement.style.top = formatUnit(top);\n  };\n\n  DragAndDrop.prototype.appendCloneElement = function (element, cloneElement) {\n    if (cloneElement === void 0) {\n      cloneElement = null;\n    }\n\n    cloneElement = isNullOrUndefined(cloneElement) ? this.actionObj.clone : cloneElement;\n    var dragElement = document.querySelector(this.parent.eventDragArea);\n\n    if (this.parent.eventDragArea && dragElement) {\n      dragElement.appendChild(cloneElement);\n    } else {\n      element.appendChild(cloneElement);\n    }\n  };\n\n  DragAndDrop.prototype.getEventWrapper = function (index, isAllDayDrag) {\n    var eventWrapper;\n\n    if (isNullOrUndefined(isAllDayDrag)) {\n      isAllDayDrag = this.actionObj.clone.classList.contains(cls.ALLDAY_APPOINTMENT_CLASS);\n    }\n\n    if (this.parent.activeViewOptions.timeScale.enable) {\n      var wrapperClass = isAllDayDrag ? '.' + cls.ALLDAY_APPOINTMENT_WRAPPER_CLASS : '.' + cls.APPOINTMENT_WRAPPER_CLASS;\n      eventWrapper = this.parent.element.querySelectorAll(wrapperClass).item(index);\n    } else {\n      var targetWrapper = this.parent.element.querySelectorAll('.' + cls.WORK_CELLS_CLASS).item(index);\n      eventWrapper = targetWrapper.querySelector('.' + cls.APPOINTMENT_WRAPPER_CLASS);\n\n      if (!eventWrapper) {\n        eventWrapper = createElement('div', {\n          className: cls.APPOINTMENT_WRAPPER_CLASS\n        });\n        targetWrapper.appendChild(eventWrapper);\n      }\n    }\n\n    return eventWrapper;\n  };\n\n  DragAndDrop.prototype.getAllDayEventHeight = function () {\n    var eventWrapper = createElement('div', {\n      className: cls.APPOINTMENT_CLASS\n    });\n    this.parent.element.querySelector('.' + cls.ALLDAY_APPOINTMENT_WRAPPER_CLASS).appendChild(eventWrapper);\n    var eventHeight = eventWrapper.offsetHeight;\n    remove(eventWrapper);\n    return eventHeight;\n  };\n\n  DragAndDrop.prototype.isAllowDrop = function (e) {\n    if (!this.actionObj.excludeSelectors) {\n      return false;\n    }\n\n    var dropSelectors = this.actionObj.excludeSelectors.split(',');\n    var isAllowDrop = false;\n\n    for (var _i = 0, dropSelectors_1 = dropSelectors; _i < dropSelectors_1.length; _i++) {\n      var selector = dropSelectors_1[_i];\n\n      if (e.target.classList.contains(selector)) {\n        isAllowDrop = true;\n        break;\n      }\n    }\n\n    return isAllowDrop;\n  };\n  /**\n   * Get module name.\n   *\n   * @returns {string} Returns the module name\n   */\n\n\n  DragAndDrop.prototype.getModuleName = function () {\n    return 'dragAndDrop';\n  };\n\n  return DragAndDrop;\n}(ActionBase);\n\nexport { DragAndDrop };","map":{"version":3,"sources":["C:/Users/Tshilidzi-PC/Documents/GitHub/Givee/Give-a-Lot/frontend/givealot/node_modules/@syncfusion/ej2-schedule/src/schedule/actions/drag.js"],"names":["__extends","extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","hasOwnProperty","__","constructor","prototype","create","createElement","closest","Draggable","extend","formatUnit","isNullOrUndefined","addClass","remove","removeClass","setStyleAttribute","ActionBase","MonthEvent","TimelineEvent","YearEvent","VerticalEvent","cls","events","util","MINUTES_PER_DAY","DragAndDrop","_super","_this","apply","arguments","widthUptoCursorPoint","heightUptoCursorPoint","cursorPointIndex","isHeaderRows","isTimelineDayProcess","widthPerMinute","heightPerMinute","minDiff","isStepDragging","isMorePopupOpened","isAllDayDrag","isMultiSelect","multiData","updatedData","swagData","startTime","isAllDayTarget","targetTd","isCursorAhead","wireDragEvent","element","dragElement","document","querySelector","parent","eventDragArea","abort","EVENT_RESIZE_CLASS","clone","isDragScroll","enableTapHold","isAdaptive","enableTailMode","cursorAt","left","top","dragArea","CONTENT_TABLE_CLASS","dragStart","bind","drag","dragStop","enableAutoScroll","helper","dragHelper","queryPositionInfo","dragPosition","e","setDragActionDefaultValues","actionObj","action","elements","allowMultiDrag","selectedElements","length","indexOf","forEach","ele","cloneElement","createCloneElement","getAttribute","currentView","activeViewOptions","timeScale","enable","activeView","isTimelineView","classList","contains","ALLDAY_APPOINTMENT_CLASS","cursor","right","width","style","offsetTop","push","originalElement","cellHeight","slotInterval","interval","leftValue","cloneRight","Math","ceil","getBoundingClientRect","CONTENT_WRAP_CLASS","contentWrapRight","enableRtl","pageX","offsetLeft","topValue","offsetParent","MORE_EVENT_POPUP_CLASS","ALLDAY_ROW_CLASS","offsetWidth","cellWidth","height","pointerEvents","top_1","parseInt","scrollHeight","cloneBottom","offsetHeight","isAllDay","slotCount","workCell","WORK_CELLS_CLASS","eventGuid","event","eventBase","getEventByGuid","eventObj","eventFields","getTime","dragArgs","cancel","data","selectedData","getSelectedData","excludeSelectors","navigation","timeDelay","scroll","scrollBy","trigger","dragEventArgs","parentElement","dragObj","ej2_instances","intDestroy","removeCloneElementClasses","removeCloneElement","actionClass","uiStateValues","start","end","endTime","groupIndex","viewElement","scrollArgs","scrollWidth","daysVariation","rows","headerRows","option","timelineEventModule","yearEvent","resetTime","Date","updateOriginalElement","monthEvent","verticalEvent","initializeValues","splitEvents","splitEvent","query","group","resources","concat","appWrap","appEle","EVENT_ACTION_CLASS","_i","_a","quickPopup","quickPopupHide","target","DISABLE_DATES","eventArgs","getPageCoordinates","Y","pageY","X","abs","calculateMinutesDiff","date","getDateFromElement","currentDate","startDate","MS_PER_DAY","targetElement","currentTarget","ROOT","updateScrollPosition","updateNavigatingPosition","updateDraggingDateTime","renderDates","startEndHours","getStartEndHours","getStartHour","getEndHour","startHour","MS_PER_MINUTE","clearInterval","navigationInterval","scrollInterval","isAllowDrop","cellTemplate","getChangedData","allowGroupEdit","rowAutoHeight","virtualScrollModule","byGroupID","crudModule","crudObj","isCrudAction","sourceEvent","resourceBase","lastResourceLevel","currentGroupIndex","targetEvent","saveChangedData","currentDate_1","getCurrentTime","window","setInterval","crtDate","getSeconds","viewNavigation","morePopupEventDragging","dateRender","getSlotDates","calculateTimelineTime","calculateVerticalDate","calculateVerticalTime","navigationWrapper","outerWrapperCls","slice","call","querySelectorAll","index","targetWrapper","APPOINTMENT_WRAPPER_CLASS","className","appendChild","wrapperClass","ALLDAY_APPOINTMENT_WRAPPER_CLASS","item","elementHeight","getAllDayEventHeight","event_2","ALLDAY_CELLS_CLASS","event_1","outWrapper","APPOINTMENT_CONTAINER_CLASS","tarWrapper_1","navigationType","scrollEdges","bottom","scrollLeft","round","pageXOffset","clientWidth","changeDate","getNextPreviousDate","eventDuration","td","dragEnd","setMilliseconds","eventContainer","eventWrapper","rowIndex","appendCloneElement","swapDragging","eventStart","eventEnd","floor","scrollTop","pageYOffset","diffInMinutes","tr","trCollections","getContentTable","cellIndex","colIndex","children","getEventWrapper","setMinutes","getMinutes","setDate","getDate","setHours","getHours","addDays","updateAllDayEvents","byDate","undefined","getUpdatedEvent","dynamicWrappers","dynamicWrappers_1","wrapper","targetCellTime_1","eventObj_1","startTimeDiff","index_1","updateMultipleData","dayIndex","getDayIndex","updateEventHeight","parentNode","updateTimePosition","eventData","isDifferentDate","scheduleStartHour","scheduleEndHour","endDate","firstEventObj","endHour","secondEventObj","timeDifference","endTimeDiff","differInDays","day","DAY_WRAPPER_CLASS","datesCount","isGroupAdaptive","i","indexGroup","dynamicIndex","getIndexOfDate","events_1","isAllDayAppointment","filterQuery","record","isSpannedEvent","eStart","fields","eEnd","appHeight","getHeight","getTopValue","renderSpannedEvents","appWidth","timeDiff","allDayDifference","appointmentElement","createAppointmentElement","isSpanned","CLONE_ELEMENT_CLASS","appointmentWrap","getRenderedDates","_b","slots","map","filter","res","cell","count","DATE_HEADER_WRAP_CLASS","eventHeight","allDayElement","allDayElement_1","tagName","workCells","timeString","eventWrappers","eventWrappers_1","getFullYear","getMonth","updateMultipleVerticalDate","dynamicYearlyEventsRendering","dynamicEventsRendering","setMonth","rightOffset","getOffsetValue","getColumnIndex","cursorDrag","leftVal","cloneIndex","cursorIndex","getCursorCurrentIndex","widthDiff","getWidthDiff","calculateIntervalTime","eventSrt","eventsData","dataIndex","events_2","getStartTime","getEndTime","getEventWidth","getPosition","calculateResourceGroupingPosition","viewEle","pages","targetLeft","getIndex","dateLength","targetDate","currentIndex","trCollection","translateY","getTranslateY","rowHeight","scrollY","isNaN","cursorElement","getCursorElement","APPOINTMENT_CLASS","dropSelectors","split","dropSelectors_1","selector","getModuleName"],"mappings":"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","sourcesContent":["var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\n/* eslint-disable @typescript-eslint/no-explicit-any */\nimport { createElement, closest, Draggable, extend, formatUnit, isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { addClass, remove, removeClass, setStyleAttribute } from '@syncfusion/ej2-base';\nimport { ActionBase } from '../actions/action-base';\nimport { MonthEvent } from '../event-renderer/month';\nimport { TimelineEvent } from '../event-renderer/timeline-view';\nimport { YearEvent } from '../event-renderer/year';\nimport { VerticalEvent } from '../event-renderer/vertical-view';\nimport * as cls from '../base/css-constant';\nimport * as events from '../base/constant';\nimport * as util from '../base/util';\nvar MINUTES_PER_DAY = 1440;\n/**\n * Schedule events drag actions\n */\nvar DragAndDrop = /** @class */ (function (_super) {\n    __extends(DragAndDrop, _super);\n    function DragAndDrop() {\n        var _this = _super !== null && _super.apply(this, arguments) || this;\n        _this.widthUptoCursorPoint = 0;\n        _this.heightUptoCursorPoint = 0;\n        _this.cursorPointIndex = 0;\n        _this.isHeaderRows = false;\n        _this.isTimelineDayProcess = false;\n        _this.widthPerMinute = 0;\n        _this.heightPerMinute = 0;\n        _this.minDiff = 0;\n        _this.isStepDragging = false;\n        _this.isMorePopupOpened = false;\n        _this.isAllDayDrag = false;\n        _this.isMultiSelect = false;\n        _this.multiData = [];\n        _this.updatedData = [];\n        _this.swagData = [];\n        _this.startTime = 0;\n        _this.isAllDayTarget = false;\n        _this.targetTd = null;\n        _this.isCursorAhead = false;\n        return _this;\n    }\n    DragAndDrop.prototype.wireDragEvent = function (element) {\n        var dragElement = document.querySelector(this.parent.eventDragArea);\n        new Draggable(element, {\n            abort: '.' + cls.EVENT_RESIZE_CLASS,\n            clone: true,\n            isDragScroll: true,\n            enableTapHold: this.parent.isAdaptive,\n            enableTailMode: (this.parent.eventDragArea) ? true : false,\n            cursorAt: (this.parent.eventDragArea) ? { left: -20, top: -20 } : { left: 0, top: 0 },\n            dragArea: (this.parent.eventDragArea && dragElement) ?\n                dragElement : this.parent.element.querySelector('.' + cls.CONTENT_TABLE_CLASS),\n            dragStart: this.dragStart.bind(this),\n            drag: this.drag.bind(this),\n            dragStop: this.dragStop.bind(this),\n            enableAutoScroll: false,\n            helper: this.dragHelper.bind(this),\n            queryPositionInfo: this.dragPosition.bind(this)\n        });\n    };\n    DragAndDrop.prototype.dragHelper = function (e) {\n        var _this = this;\n        this.setDragActionDefaultValues();\n        this.actionObj.element = e.element;\n        this.actionObj.action = 'drag';\n        var elements = [];\n        if (!this.parent.allowMultiDrag || isNullOrUndefined(this.parent.selectedElements) || this.parent.selectedElements.length === 0 ||\n            (this.parent.selectedElements.length > 0 && this.parent.selectedElements.indexOf(this.actionObj.element) === -1)) {\n            elements = [e.element];\n        }\n        else {\n            elements = this.parent.selectedElements;\n            this.isMultiSelect = true;\n        }\n        elements.forEach(function (ele) {\n            var cloneElement = _this.createCloneElement(ele);\n            if (ele.getAttribute('data-guid') === _this.actionObj.element.getAttribute('data-guid')) {\n                _this.actionObj.clone = cloneElement;\n                if (!_this.parent.eventDragArea && _this.parent.currentView !== 'Month' &&\n                    _this.parent.activeViewOptions.timeScale.enable && !_this.parent.activeView.isTimelineView() &&\n                    !_this.actionObj.element.classList.contains(cls.ALLDAY_APPOINTMENT_CLASS)) {\n                    setStyleAttribute(_this.actionObj.clone, { cursor: 'move', left: '0%', right: '0%', width: '100%' });\n                }\n                _this.actionObj.clone.style.top = formatUnit(_this.actionObj.element.offsetTop);\n            }\n            _this.actionObj.cloneElement.push(cloneElement);\n            _this.actionObj.originalElement.push(ele);\n        });\n        return this.actionObj.clone;\n    };\n    DragAndDrop.prototype.dragPosition = function (e) {\n        if (this.parent.eventDragArea) {\n            return { left: e.left, top: e.top };\n        }\n        var cellHeight = (this.actionObj.cellHeight / this.actionObj.slotInterval) * this.actionObj.interval;\n        var leftValue = formatUnit(0);\n        if (this.parent.currentView === 'Month') {\n            leftValue = e.left;\n        }\n        var cloneRight;\n        if (this.isStepDragging) {\n            cloneRight = Math.ceil(this.actionObj.clone.getBoundingClientRect().right) + this.actionObj.interval;\n        }\n        else {\n            cloneRight = this.actionObj.clone.getBoundingClientRect().right;\n        }\n        var dragArea = this.parent.element.querySelector('.' + cls.CONTENT_WRAP_CLASS);\n        var contentWrapRight = dragArea.getBoundingClientRect().right;\n        if (this.parent.activeView.isTimelineView() && this.parent.currentView !== 'TimelineYear' && !this.parent.enableRtl &&\n            this.actionObj.pageX > cloneRight && !this.isMorePopupOpened && !(this.actionObj.pageX > contentWrapRight)) {\n            this.isCursorAhead = true;\n        }\n        if (this.parent.activeView.isTimelineView()) {\n            leftValue = formatUnit(this.actionObj.clone.offsetLeft);\n        }\n        var topValue;\n        if ((this.parent.activeView.isTimelineView() || !this.parent.timeScale.enable ||\n            (!isNullOrUndefined(this.actionObj.clone.offsetParent) &&\n                this.actionObj.clone.offsetParent.classList.contains(cls.MORE_EVENT_POPUP_CLASS)))) {\n            topValue = formatUnit(this.actionObj.clone.offsetTop);\n        }\n        else if (this.parent.currentView === 'Month') {\n            topValue = formatUnit(0);\n        }\n        else if (this.actionObj.clone.classList.contains(cls.ALLDAY_APPOINTMENT_CLASS)) {\n            topValue = formatUnit(this.parent.element.querySelector('.' + cls.ALLDAY_ROW_CLASS).offsetTop);\n            setStyleAttribute(this.actionObj.clone, {\n                width: formatUnit(Math.ceil(this.actionObj.clone.offsetWidth / this.actionObj.cellWidth) * this.actionObj.cellWidth),\n                right: this.parent.enableRtl && formatUnit(0)\n            });\n        }\n        else {\n            if (this.actionObj.element.classList.contains(cls.ALLDAY_APPOINTMENT_CLASS) &&\n                !this.actionObj.clone.classList.contains(cls.ALLDAY_APPOINTMENT_CLASS)) {\n                setStyleAttribute(this.actionObj.clone, {\n                    height: formatUnit(this.actionObj.cellHeight),\n                    width: formatUnit(this.actionObj.cellWidth - 1),\n                    pointerEvents: 'none'\n                });\n            }\n            var top_1 = parseInt(e.top, 10);\n            top_1 = top_1 < 0 ? 0 : top_1;\n            topValue = formatUnit(Math.ceil(top_1 / cellHeight) * cellHeight);\n            var scrollHeight = this.parent.element.querySelector('.e-content-wrap').scrollHeight;\n            var cloneBottom = parseInt(topValue, 10) + this.actionObj.clone.offsetHeight;\n            if (cloneBottom > scrollHeight) {\n                topValue = (parseInt(topValue, 10) - (cloneBottom - scrollHeight)) + 'px';\n            }\n        }\n        return { left: leftValue, top: topValue };\n    };\n    DragAndDrop.prototype.setDragActionDefaultValues = function () {\n        this.actionObj.action = 'drag';\n        this.actionObj.isAllDay = null;\n        this.actionObj.slotInterval = this.parent.activeViewOptions.timeScale.interval / this.parent.activeViewOptions.timeScale.slotCount;\n        this.actionObj.interval = this.actionObj.slotInterval;\n        var workCell = this.parent.element.querySelector('.' + cls.WORK_CELLS_CLASS);\n        this.actionObj.cellWidth = workCell.offsetWidth;\n        this.actionObj.cellHeight = workCell.offsetHeight;\n    };\n    DragAndDrop.prototype.dragStart = function (e) {\n        var _this = this;\n        var eventGuid = this.actionObj.element.getAttribute('data-guid');\n        this.actionObj.event = this.parent.eventBase.getEventByGuid(eventGuid);\n        var eventObj = extend({}, this.actionObj.event, null, true);\n        this.startTime = eventObj[this.parent.eventFields.startTime].getTime();\n        var dragArgs = {\n            cancel: false,\n            data: eventObj,\n            selectedData: this.getSelectedData(),\n            event: e,\n            excludeSelectors: null,\n            element: this.actionObj.element,\n            interval: this.actionObj.interval,\n            navigation: { enable: false, timeDelay: 2000 },\n            scroll: { enable: true, scrollBy: 30, timeDelay: 100 }\n        };\n        this.parent.trigger(events.dragStart, dragArgs, function (dragEventArgs) {\n            if (dragEventArgs.cancel || (!isNullOrUndefined(_this.actionObj.element) &&\n                isNullOrUndefined(_this.actionObj.element.parentElement))) {\n                var dragObj = _this.actionObj.element.ej2_instances[0];\n                if (!isNullOrUndefined(dragObj)) {\n                    dragObj.intDestroy(e.event);\n                }\n                _this.actionObj.action = '';\n                _this.removeCloneElementClasses();\n                _this.removeCloneElement();\n                return;\n            }\n            _this.actionClass('addClass');\n            _this.parent.uiStateValues.action = true;\n            _this.actionObj.start = eventObj[_this.parent.eventFields.startTime];\n            _this.actionObj.end = eventObj[_this.parent.eventFields.endTime];\n            _this.actionObj.groupIndex = parseInt(_this.actionObj.element.getAttribute('data-group-index') || '0', 10);\n            _this.actionObj.interval = dragEventArgs.interval;\n            _this.actionObj.navigation = dragEventArgs.navigation;\n            _this.actionObj.scroll = dragEventArgs.scroll;\n            _this.actionObj.excludeSelectors = dragEventArgs.excludeSelectors;\n            var viewElement = _this.parent.element.querySelector('.' + cls.CONTENT_WRAP_CLASS);\n            _this.scrollArgs = { element: viewElement, width: viewElement.scrollWidth, height: viewElement.scrollHeight };\n            _this.widthPerMinute = (_this.actionObj.cellWidth / _this.actionObj.slotInterval) * _this.actionObj.interval;\n            _this.heightPerMinute = (_this.actionObj.cellHeight / _this.actionObj.slotInterval) * _this.actionObj.interval;\n            _this.widthUptoCursorPoint = 0;\n            _this.heightUptoCursorPoint = 0;\n            _this.cursorPointIndex = -1;\n            _this.isHeaderRows = false;\n            _this.isTimelineDayProcess = false;\n            _this.minDiff = 0;\n            _this.isMorePopupOpened = false;\n            _this.daysVariation = -1;\n            _this.isAllDayTarget = _this.actionObj.clone.classList.contains(cls.ALLDAY_APPOINTMENT_CLASS);\n            if ((_this.parent.activeView.isTimelineView() || !_this.parent.timeScale.enable) && _this.parent.currentView !== 'TimelineYear') {\n                if (!isNullOrUndefined(_this.actionObj.clone.offsetParent) &&\n                    _this.actionObj.clone.offsetParent.classList.contains(cls.MORE_EVENT_POPUP_CLASS)) {\n                    _this.isMorePopupOpened = true;\n                }\n                _this.actionObj.pageX = e.event.pageX;\n                var rows = _this.parent.activeViewOptions.headerRows;\n                _this.isHeaderRows = rows.length > 0 && rows[rows.length - 1].option !== 'Hour' &&\n                    rows[rows.length - 1].option !== 'Date';\n                _this.isTimelineDayProcess = !_this.parent.activeViewOptions.timeScale.enable || _this.isHeaderRows ||\n                    _this.parent.currentView === 'TimelineMonth' || (rows.length > 0 && rows[rows.length - 1].option === 'Date');\n                _this.isStepDragging = !_this.isTimelineDayProcess && (_this.actionObj.slotInterval !== _this.actionObj.interval);\n                if (_this.isTimelineDayProcess) {\n                    _this.timelineEventModule = new TimelineEvent(_this.parent, 'day');\n                }\n                else {\n                    _this.timelineEventModule = new TimelineEvent(_this.parent, 'hour');\n                }\n            }\n            if (_this.parent.currentView === 'TimelineYear') {\n                _this.yearEvent = new YearEvent(_this.parent);\n            }\n            if (_this.parent.currentView === 'Month') {\n                _this.startTime = util.resetTime(new Date(_this.startTime)).getTime();\n                _this.updateOriginalElement(_this.actionObj.clone);\n                _this.monthEvent = new MonthEvent(_this.parent);\n            }\n            if (_this.parent.currentView === 'Day' || _this.parent.currentView === 'Week' || _this.parent.currentView === 'WorkWeek') {\n                _this.verticalEvent = new VerticalEvent(_this.parent);\n                _this.verticalEvent.initializeValues();\n                var splitEvents = _this.splitEvent(_this.actionObj.event);\n                splitEvents.forEach(function (event) {\n                    var query = \".e-day-wrapper[data-date=\\\"\" + util.resetTime(event[_this.parent.eventFields.startTime]).getTime() + \"\\\"]\";\n                    if (_this.parent.activeViewOptions.group.resources.length > 0) {\n                        query = query.concat('[data-group-index = \"' + _this.actionObj.groupIndex + '\"]');\n                    }\n                    var appWrap = _this.parent.element.querySelector(query);\n                    if (appWrap) {\n                        var appEle = appWrap.querySelector('[data-id=\"' + _this.actionObj.clone.getAttribute('data-id') + '\"]');\n                        if (appEle) {\n                            addClass([appEle], cls.EVENT_ACTION_CLASS);\n                        }\n                    }\n                });\n            }\n        });\n    };\n    DragAndDrop.prototype.getSelectedData = function () {\n        if (this.isMultiSelect && this.multiData.length === 0 && this.parent.selectedElements.length > 0) {\n            for (var _i = 0, _a = this.parent.selectedElements; _i < _a.length; _i++) {\n                var element = _a[_i];\n                var eventGuid = element.getAttribute('data-guid');\n                var data = this.parent.eventBase.getEventByGuid(eventGuid);\n                this.multiData.push(extend({}, data, null, true));\n            }\n        }\n        return this.multiData;\n    };\n    DragAndDrop.prototype.drag = function (e) {\n        if (this.parent.quickPopup) {\n            this.parent.quickPopup.quickPopupHide(true);\n        }\n        if ((!isNullOrUndefined(e.target)) && e.target.classList.contains(cls.DISABLE_DATES)) {\n            return;\n        }\n        var eventObj = extend({}, this.actionObj.event, null, true);\n        var eventArgs = this.getPageCoordinates(e);\n        this.actionObj.Y = this.actionObj.pageY = eventArgs.pageY;\n        this.actionObj.X = this.actionObj.pageX = eventArgs.pageX;\n        this.actionObj.target = e.target;\n        this.widthUptoCursorPoint = (this.widthUptoCursorPoint === 0) ?\n            Math.ceil((Math.abs(this.actionObj.clone.getBoundingClientRect().left - this.actionObj.X) / this.widthPerMinute)) *\n                this.widthPerMinute : this.widthUptoCursorPoint;\n        this.widthUptoCursorPoint = this.isMorePopupOpened ? this.actionObj.cellWidth : this.widthUptoCursorPoint;\n        this.heightUptoCursorPoint = (this.heightUptoCursorPoint === 0) ?\n            Math.ceil((Math.abs(this.actionObj.clone.getBoundingClientRect().top - this.actionObj.Y) / this.heightPerMinute)) *\n                this.heightPerMinute : this.heightUptoCursorPoint;\n        this.isAllDayDrag = (this.parent.activeViewOptions.timeScale.enable) ?\n            this.actionObj.clone.classList.contains(cls.ALLDAY_APPOINTMENT_CLASS) :\n            this.actionObj.event[this.parent.eventFields.isAllDay];\n        if (this.isStepDragging && this.minDiff === 0) {\n            this.calculateMinutesDiff(eventObj);\n        }\n        if ((this.parent.currentView === 'Month' || this.isAllDayDrag) && this.daysVariation < 0) {\n            var date = this.parent.getDateFromElement(this.actionObj.target);\n            if (!isNullOrUndefined(date)) {\n                var currentDate = util.resetTime(date);\n                var startDate = util.resetTime(new Date(eventObj[this.parent.eventFields.startTime].getTime()));\n                this.daysVariation = (currentDate.getTime() - startDate.getTime()) / util.MS_PER_DAY;\n            }\n            else {\n                this.daysVariation = 0;\n            }\n        }\n        else {\n            this.daysVariation = 0;\n        }\n        if (this.parent.eventDragArea) {\n            var targetElement = eventArgs.target;\n            this.actionObj.clone.style.top = formatUnit(targetElement.offsetTop);\n            this.actionObj.clone.style.left = formatUnit(targetElement.offsetLeft);\n            var currentTarget = closest(targetElement, '.' + cls.ROOT);\n            if (!currentTarget) {\n                this.actionObj.clone.style.height = '';\n                this.actionObj.clone.style.width = '';\n            }\n            else {\n                if (!(this.parent.currentView === 'Week' || this.parent.currentView === 'WorkWeek' || this.parent.currentView === 'Day')) {\n                    this.actionObj.clone.style.width = formatUnit(this.actionObj.element.offsetWidth);\n                }\n            }\n        }\n        this.updateScrollPosition(e);\n        this.updateNavigatingPosition(e);\n        this.updateDraggingDateTime(e);\n        var dragArgs = {\n            data: eventObj, event: e, element: this.actionObj.element, startTime: this.actionObj.start,\n            endTime: this.actionObj.end, selectedData: this.updatedData\n        };\n        if (this.parent.group.resources.length > 0) {\n            dragArgs.groupIndex = this.actionObj.groupIndex;\n        }\n        this.parent.trigger(events.drag, dragArgs);\n    };\n    DragAndDrop.prototype.calculateMinutesDiff = function (eventObj) {\n        if (this.parent.enableRtl) {\n            this.minDiff =\n                ((this.actionObj.clone.offsetWidth - this.widthUptoCursorPoint) / this.widthPerMinute) * this.actionObj.interval;\n        }\n        else {\n            this.minDiff = (this.widthUptoCursorPoint / this.widthPerMinute) * this.actionObj.interval;\n        }\n        var startDate = eventObj[this.parent.eventFields.startTime];\n        var startTime = this.parent.activeView.renderDates[0];\n        var startEndHours = util.getStartEndHours(startTime, this.parent.activeView.getStartHour(), this.parent.activeView.getEndHour());\n        if (startEndHours.startHour.getTime() > startDate.getTime()) {\n            this.minDiff = this.minDiff + ((startEndHours.startHour.getTime() - startDate.getTime()) / util.MS_PER_MINUTE);\n        }\n    };\n    DragAndDrop.prototype.dragStop = function (e) {\n        var _this = this;\n        this.isCursorAhead = false;\n        this.removeCloneElementClasses();\n        this.removeCloneElement();\n        clearInterval(this.actionObj.navigationInterval);\n        this.actionObj.navigationInterval = null;\n        clearInterval(this.actionObj.scrollInterval);\n        this.actionObj.scrollInterval = null;\n        this.actionClass('removeClass');\n        this.parent.uiStateValues.action = false;\n        this.actionObj.action = null;\n        if (this.isAllowDrop(e)) {\n            return;\n        }\n        var target = ((!e.target.classList.contains('e-work-cells') && this.parent.cellTemplate) ?\n            closest(e.target, '.e-work-cells') : e.target);\n        var dragArgs = {\n            cancel: false, data: this.getChangedData(this.updatedData), selectedData: this.updatedData,\n            event: e, element: this.actionObj.element, target: target\n        };\n        this.parent.trigger(events.dragStop, dragArgs, function (dragEventArgs) {\n            if (dragEventArgs.cancel) {\n                return;\n            }\n            if (_this.parent.activeViewOptions.group.resources.length > 0 && !_this.parent.activeViewOptions.group.allowGroupEdit\n                && !_this.parent.rowAutoHeight && !_this.parent.virtualScrollModule && _this.parent.activeViewOptions.group.byGroupID) {\n                _this.parent.crudModule.crudObj.isCrudAction = true;\n                _this.parent.crudModule.crudObj.sourceEvent =\n                    [_this.parent.resourceBase.lastResourceLevel[parseInt(dragArgs.element.getAttribute('data-group-index'), 10)]];\n                var currentGroupIndex = parseInt(dragArgs.target.getAttribute('data-group-index'), 10) || _this.actionObj.groupIndex;\n                _this.parent.crudModule.crudObj.targetEvent = [_this.parent.resourceBase.lastResourceLevel[currentGroupIndex]];\n            }\n            _this.saveChangedData(dragEventArgs, _this.isMultiSelect);\n        });\n        this.updatedData = [];\n        this.multiData = [];\n        this.isMultiSelect = false;\n        this.parent.selectedElements = [];\n    };\n    DragAndDrop.prototype.updateNavigatingPosition = function (e) {\n        var _this = this;\n        if (this.actionObj.navigation.enable) {\n            var currentDate_1 = this.parent.getCurrentTime();\n            if (isNullOrUndefined(this.actionObj.navigationInterval)) {\n                this.actionObj.navigationInterval = window.setInterval(function () {\n                    if (currentDate_1) {\n                        var crtDate = _this.parent.getCurrentTime();\n                        var end = crtDate.getSeconds();\n                        var start = currentDate_1.getSeconds() + (_this.actionObj.navigation.timeDelay / 1000);\n                        start = (start >= 60) ? start - 60 : start;\n                        if (start === end) {\n                            currentDate_1 = _this.parent.getCurrentTime();\n                            _this.viewNavigation(e);\n                            _this.updateDraggingDateTime(e);\n                        }\n                    }\n                }, this.actionObj.navigation.timeDelay);\n            }\n        }\n    };\n    DragAndDrop.prototype.updateDraggingDateTime = function (e) {\n        if (!isNullOrUndefined(this.actionObj.clone.offsetParent) &&\n            this.actionObj.clone.offsetParent.classList.contains(cls.MORE_EVENT_POPUP_CLASS)) {\n            this.morePopupEventDragging(e);\n        }\n        else if (this.parent.activeView.isTimelineView() && this.parent.currentView !== 'TimelineYear') {\n            this.timelineEventModule.dateRender = this.parent.activeView.renderDates;\n            this.timelineEventModule.cellWidth = this.actionObj.cellWidth;\n            this.timelineEventModule.getSlotDates();\n            this.actionObj.cellWidth = this.isHeaderRows ? this.timelineEventModule.cellWidth : this.actionObj.cellWidth;\n            this.calculateTimelineTime(e);\n        }\n        else {\n            if (this.parent.currentView === 'Month' || this.parent.currentView === 'TimelineYear') {\n                this.calculateVerticalDate(e);\n            }\n            else {\n                this.calculateVerticalTime(e);\n            }\n        }\n    };\n    DragAndDrop.prototype.navigationWrapper = function () {\n        if (!this.parent.activeView.isTimelineView()) {\n            if (this.parent.currentView === 'Month' || !this.parent.timeScale.enable) {\n                var outerWrapperCls = [].slice.call(this.parent.element.querySelectorAll('.' + cls.WORK_CELLS_CLASS));\n                this.actionObj.index = (this.parent.activeView.renderDates.length < this.actionObj.index) ?\n                    this.parent.activeView.renderDates.length - 1 : this.actionObj.index;\n                var targetWrapper = outerWrapperCls[this.actionObj.index].querySelector('.' + cls.APPOINTMENT_WRAPPER_CLASS);\n                if (!targetWrapper) {\n                    targetWrapper = createElement('div', { className: cls.APPOINTMENT_WRAPPER_CLASS });\n                    outerWrapperCls[this.actionObj.index].appendChild(targetWrapper);\n                }\n                targetWrapper.appendChild(this.actionObj.clone);\n            }\n            else {\n                var wrapperClass = this.actionObj.clone.classList.contains(cls.ALLDAY_APPOINTMENT_CLASS) ?\n                    '.' + cls.ALLDAY_APPOINTMENT_WRAPPER_CLASS : '.' + cls.APPOINTMENT_WRAPPER_CLASS;\n                this.parent.element.querySelectorAll(wrapperClass)\n                    .item(this.actionObj.index).appendChild(this.actionObj.clone);\n                if (wrapperClass === '.' + cls.ALLDAY_APPOINTMENT_WRAPPER_CLASS) {\n                    var elementHeight = this.getAllDayEventHeight();\n                    var event_2 = [].slice.call(this.parent.element.querySelectorAll('.' + cls.ALLDAY_CELLS_CLASS + ':first-child'));\n                    if (event_2[0].offsetHeight < elementHeight) {\n                        for (var _i = 0, event_1 = event_2; _i < event_1.length; _i++) {\n                            var e = event_1[_i];\n                            e.style.height = ((elementHeight + 2) / 12) + 'em';\n                        }\n                    }\n                    this.actionObj.clone.style.height = formatUnit(elementHeight);\n                }\n                this.actionObj.height = parseInt(this.actionObj.clone.style.height, 10);\n            }\n        }\n        else {\n            var outWrapper = void 0;\n            if (this.parent.activeViewOptions.group.resources.length > 0) {\n                outWrapper = this.parent.element.querySelectorAll('.e-appointment-container:not(.e-hidden)').item(this.actionObj.index);\n            }\n            else {\n                outWrapper = this.parent.element.querySelector('.' + cls.APPOINTMENT_CONTAINER_CLASS);\n            }\n            var tarWrapper_1 = outWrapper.querySelector('.' + cls.APPOINTMENT_WRAPPER_CLASS);\n            if (!tarWrapper_1) {\n                tarWrapper_1 = createElement('div', { className: cls.APPOINTMENT_WRAPPER_CLASS });\n                outWrapper.appendChild(tarWrapper_1);\n            }\n            this.actionObj.cloneElement.forEach(function (ele) {\n                tarWrapper_1.appendChild(ele);\n            });\n        }\n    };\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    DragAndDrop.prototype.viewNavigation = function (e) {\n        var navigationType;\n        var dragArea = this.parent.element.querySelector('.' + cls.CONTENT_WRAP_CLASS);\n        if (dragArea && ((!this.scrollEdges.top && !this.scrollEdges.bottom) ||\n            closest(this.actionObj.clone, '.' + cls.ALLDAY_APPOINTMENT_WRAPPER_CLASS))) {\n            if ((dragArea.scrollLeft === 0) &&\n                (Math.round(this.actionObj.X) <=\n                    Math.round(dragArea.getBoundingClientRect().left + this.actionObj.cellWidth + window.pageXOffset))) {\n                navigationType = this.parent.enableRtl ? 'next' : 'previous';\n            }\n            else if ((Math.round(dragArea.scrollLeft) + dragArea.clientWidth === dragArea.scrollWidth) &&\n                (Math.round(this.actionObj.X) >=\n                    Math.round(dragArea.getBoundingClientRect().right - this.actionObj.cellWidth + window.pageXOffset))) {\n                navigationType = this.parent.enableRtl ? 'previous' : 'next';\n            }\n            if (navigationType) {\n                this.parent.changeDate(this.parent.activeView.getNextPreviousDate(navigationType));\n            }\n        }\n    };\n    DragAndDrop.prototype.morePopupEventDragging = function (e) {\n        if (isNullOrUndefined(e.target) || (e.target && isNullOrUndefined(closest(e.target, 'td')))) {\n            return;\n        }\n        var eventObj = extend({}, this.actionObj.event, null, true);\n        var eventDuration = eventObj[this.parent.eventFields.endTime].getTime() -\n            eventObj[this.parent.eventFields.startTime].getTime();\n        var td = closest(e.target, 'td');\n        if (this.parent.currentView === 'TimelineYear' && !td.classList.contains('e-work-cells')) {\n            return;\n        }\n        var dragStart = this.parent.getDateFromElement(td);\n        var dragEnd = new Date(dragStart.getTime());\n        dragEnd.setMilliseconds(eventDuration);\n        if (this.parent.activeViewOptions.group.resources.length > 0) {\n            this.actionObj.groupIndex = parseInt(td.getAttribute('data-group-index'), 10);\n        }\n        this.actionObj.start = new Date(dragStart.getTime());\n        this.actionObj.end = new Date(dragEnd.getTime());\n        this.actionObj.clone.style.top = formatUnit(td.offsetParent.offsetTop);\n        this.actionObj.clone.style.left = formatUnit(td.offsetLeft);\n        this.actionObj.clone.style.width = formatUnit(td.offsetWidth);\n        var eventContainer = td;\n        var eventWrapper;\n        if (this.parent.activeView.isTimelineView()) {\n            var rowIndex = closest(td, 'tr').rowIndex;\n            eventContainer = this.parent.element.querySelectorAll('.e-appointment-container').item(rowIndex);\n        }\n        eventWrapper = eventContainer.querySelector('.' + cls.APPOINTMENT_WRAPPER_CLASS);\n        if (!eventWrapper) {\n            eventWrapper = createElement('div', { className: cls.APPOINTMENT_WRAPPER_CLASS });\n            eventContainer.appendChild(eventWrapper);\n        }\n        this.appendCloneElement(eventWrapper);\n    };\n    DragAndDrop.prototype.calculateVerticalTime = function (e) {\n        var _this = this;\n        if (isNullOrUndefined(this.actionObj.target) ||\n            (this.actionObj.target && isNullOrUndefined(closest(this.actionObj.target, 'tr'))) ||\n            (!(closest(this.actionObj.target, 'td').classList.contains(cls.WORK_CELLS_CLASS)) &&\n                !(closest(this.actionObj.target, 'td').classList.contains(cls.ALLDAY_CELLS_CLASS)))) {\n            return;\n        }\n        if (this.parent.activeViewOptions.timeScale.enable) {\n            this.swapDragging(e);\n        }\n        var dragArea = this.parent.element.querySelector('.' + cls.CONTENT_WRAP_CLASS);\n        var eventObj = extend({}, this.actionObj.event, null, true);\n        var eventStart = eventObj[this.parent.eventFields.startTime];\n        var eventEnd = eventObj[this.parent.eventFields.endTime];\n        var eventDuration = eventEnd.getTime() - eventStart.getTime();\n        var offsetTop = Math.floor(parseInt(this.actionObj.clone.style.top, 10) / this.actionObj.cellHeight)\n            * this.actionObj.cellHeight;\n        offsetTop = offsetTop < 0 ? 0 : offsetTop;\n        if (this.scrollEdges.top || this.scrollEdges.bottom) {\n            offsetTop = this.scrollEdges.top ? dragArea.scrollTop - this.heightUptoCursorPoint +\n                this.actionObj.cellHeight + window.pageYOffset :\n                (dragArea.scrollTop + dragArea.offsetHeight - this.actionObj.clone.offsetHeight + window.pageYOffset) +\n                    (this.actionObj.clone.offsetHeight - this.heightUptoCursorPoint);\n            offsetTop = Math.round(offsetTop / this.actionObj.cellHeight) * this.actionObj.cellHeight;\n            this.actionObj.clone.style.top = formatUnit(offsetTop);\n        }\n        var rowIndex = (this.parent.activeViewOptions.timeScale.enable) ? (offsetTop / this.actionObj.cellHeight) : 0;\n        var heightPerMinute = this.actionObj.cellHeight / this.actionObj.slotInterval;\n        var diffInMinutes = parseInt(this.actionObj.clone.style.top, 10) - offsetTop;\n        var tr;\n        if (this.isAllDayDrag) {\n            tr = this.parent.element.querySelector('.' + cls.ALLDAY_ROW_CLASS);\n        }\n        else {\n            var trCollections = [].slice.call(this.parent.getContentTable().querySelectorAll('tr'));\n            tr = trCollections[rowIndex];\n        }\n        var index;\n        if (closest(this.actionObj.target, 'td').classList.contains(cls.WORK_CELLS_CLASS) ||\n            closest(this.actionObj.target, 'td').classList.contains(cls.ALLDAY_CELLS_CLASS)) {\n            index = closest(this.actionObj.target, 'td').cellIndex;\n        }\n        var colIndex = isNullOrUndefined(index) ? closest(this.actionObj.clone, 'td').cellIndex : index;\n        this.actionObj.index = colIndex;\n        if (isNullOrUndefined(tr)) {\n            return;\n        }\n        var td = tr.children[colIndex];\n        if (this.parent.activeViewOptions.group.resources.length > 0) {\n            this.actionObj.groupIndex = parseInt(td.getAttribute('data-group-index'), 10);\n        }\n        var dragStart;\n        var dragEnd;\n        if (this.parent.activeViewOptions.timeScale.enable && !this.isAllDayDrag) {\n            this.appendCloneElement(this.getEventWrapper(colIndex));\n            dragStart = this.parent.getDateFromElement(td);\n            dragStart.setMinutes(dragStart.getMinutes() + (diffInMinutes / heightPerMinute));\n            dragEnd = new Date(dragStart.getTime());\n            if (this.actionObj.element.classList.contains(cls.ALLDAY_APPOINTMENT_CLASS)) {\n                dragEnd.setMinutes(dragEnd.getMinutes() + this.actionObj.slotInterval);\n            }\n            else {\n                dragEnd.setMilliseconds(eventDuration);\n            }\n        }\n        else {\n            dragStart = this.parent.getDateFromElement(td);\n            dragStart.setDate(dragStart.getDate() - this.daysVariation);\n            dragStart.setHours(eventStart.getHours(), eventStart.getMinutes(), eventStart.getSeconds());\n            dragEnd = new Date(dragStart.getTime());\n            dragEnd.setMilliseconds(eventDuration);\n            if (!this.actionObj.element.classList.contains(cls.ALLDAY_APPOINTMENT_CLASS) &&\n                this.actionObj.clone.classList.contains(cls.ALLDAY_APPOINTMENT_CLASS)) {\n                dragEnd = util.addDays(util.resetTime(dragEnd), 1);\n            }\n            this.updateAllDayEvents(dragStart, dragEnd, this.parent.activeViewOptions.group.byDate ? colIndex : undefined);\n        }\n        this.actionObj.start = new Date(+dragStart);\n        this.actionObj.end = new Date(+dragEnd);\n        var event = this.getUpdatedEvent(this.actionObj.start, this.actionObj.end, this.actionObj.event);\n        var dynamicWrappers = [].slice.call(this.parent.element.querySelectorAll('.e-dynamic-clone'));\n        for (var _i = 0, dynamicWrappers_1 = dynamicWrappers; _i < dynamicWrappers_1.length; _i++) {\n            var wrapper = dynamicWrappers_1[_i];\n            remove(wrapper);\n        }\n        if (this.multiData.length > 0) {\n            if (this.isAllDayTarget && this.isAllDayDrag && !isNullOrUndefined(this.actionObj.isAllDay) && !this.actionObj.isAllDay) {\n                var targetCellTime_1 = parseInt((closest(this.actionObj.target, 'td')).getAttribute('data-date'), 10);\n                this.multiData.forEach(function (data) {\n                    _this.swagData.push(extend({}, data, null, true));\n                    if (data[_this.parent.eventFields.isAllDay]) {\n                        data[_this.parent.eventFields.startTime] =\n                            new Date(data[_this.parent.eventFields.startTime].getTime() + (targetCellTime_1 - _this.startTime));\n                        var startTime = new Date(data[_this.parent.eventFields.startTime]);\n                        var endTime = new Date(startTime.setMinutes(startTime.getMinutes() + _this.actionObj.slotInterval));\n                        data[_this.parent.eventFields.endTime] = endTime;\n                        data[_this.parent.eventFields.isAllDay] = false;\n                    }\n                });\n                this.startTime = targetCellTime_1;\n            }\n            if (this.isAllDayTarget && this.isAllDayDrag &&\n                !isNullOrUndefined(this.actionObj.isAllDay) && this.actionObj.isAllDay && this.swagData.length > 0) {\n                this.multiData = this.swagData;\n                this.swagData = [];\n                var eventObj_1 = extend({}, this.actionObj.event, null, true);\n                this.startTime = eventObj_1[this.parent.eventFields.startTime].getTime();\n            }\n            var startTimeDiff = event[this.parent.eventFields.startTime].getTime() - this.startTime;\n            for (var index_1 = 0; index_1 < this.multiData.length; index_1++) {\n                this.updatedData[index_1] = this.updateMultipleData(this.multiData[index_1], startTimeDiff);\n                var dayIndex = this.getDayIndex(this.updatedData[index_1]);\n                if (dayIndex >= 0) {\n                    var wrapper = this.getEventWrapper(dayIndex, this.updatedData[index_1][this.parent.eventFields.isAllDay]);\n                    this.appendCloneElement(wrapper, this.actionObj.cloneElement[index_1]);\n                    this.updateEventHeight(this.updatedData[index_1], index_1, dayIndex);\n                }\n                else {\n                    if (!isNullOrUndefined(this.actionObj.cloneElement[index_1].parentNode)) {\n                        remove(this.actionObj.cloneElement[index_1]);\n                    }\n                }\n            }\n        }\n        else {\n            this.updateEventHeight(event);\n        }\n        this.updateTimePosition(this.actionObj.start, this.updatedData);\n    };\n    DragAndDrop.prototype.splitEvent = function (event) {\n        var eventFields = this.parent.eventFields;\n        var eventData = [];\n        var startTime = event[eventFields.startTime];\n        var endTime = event[eventFields.endTime];\n        var isDifferentDate = util.resetTime(new Date(startTime.getTime())) < util.resetTime(new Date(endTime.getTime()));\n        if (isDifferentDate) {\n            var scheduleStartHour = this.parent.activeView.getStartHour();\n            var scheduleEndHour = this.parent.activeView.getEndHour();\n            var startDate = util.getStartEndHours(util.resetTime(startTime), scheduleStartHour, scheduleEndHour);\n            var endDate = util.getStartEndHours(util.resetTime(endTime), scheduleStartHour, scheduleEndHour);\n            var firstEventObj = extend({}, event, null, true);\n            firstEventObj[eventFields.endTime] = startDate.endHour;\n            eventData.push(firstEventObj);\n            var secondEventObj = extend({}, event, null, true);\n            secondEventObj[eventFields.startTime] = endDate.startHour;\n            eventData.push(secondEventObj);\n        }\n        else {\n            eventData.push(event);\n        }\n        return eventData;\n    };\n    DragAndDrop.prototype.updateMultipleData = function (data, timeDifference) {\n        var eventObj = extend({}, data, null, true);\n        if (!isNullOrUndefined(this.actionObj.isAllDay) && this.parent.activeViewOptions.timeScale.enable &&\n            ((this.isAllDayTarget && eventObj[this.parent.eventFields.isAllDay]) ||\n                (!this.isAllDayTarget && !eventObj[this.parent.eventFields.isAllDay]))) {\n            eventObj[this.parent.eventFields.isAllDay] = this.actionObj.isAllDay;\n        }\n        var endTimeDiff = eventObj[this.parent.eventFields.endTime].getTime() -\n            eventObj[this.parent.eventFields.startTime].getTime();\n        if (eventObj[this.parent.eventFields.isAllDay]) {\n            var differInDays = Math.ceil(timeDifference / (1000 * 3600 * 24));\n            var day = Math.ceil(endTimeDiff / (1000 * 3600 * 24));\n            var startTime = new Date(eventObj[this.parent.eventFields.startTime]);\n            eventObj[this.parent.eventFields.startTime] = util.resetTime(new Date(startTime.setDate(startTime.getDate() + differInDays)));\n            eventObj[this.parent.eventFields.endTime] = util.addDays(eventObj[this.parent.eventFields.startTime], day);\n        }\n        else {\n            eventObj[this.parent.eventFields.startTime] =\n                new Date(eventObj[this.parent.eventFields.startTime].getTime() + timeDifference);\n            eventObj[this.parent.eventFields.endTime] =\n                new Date(eventObj[this.parent.eventFields.startTime].getTime() + endTimeDiff);\n        }\n        return eventObj;\n    };\n    DragAndDrop.prototype.getDayIndex = function (event) {\n        var eventObj = extend({}, event, null, true);\n        var startTime = util.resetTime(eventObj[this.parent.eventFields.startTime]).getTime();\n        var query = '';\n        var wrapper = cls.DAY_WRAPPER_CLASS;\n        if (this.parent.activeViewOptions.timeScale.enable && (eventObj[this.parent.eventFields.isAllDay])) {\n            wrapper = cls.ALLDAY_APPOINTMENT_WRAPPER_CLASS;\n        }\n        else {\n            wrapper = cls.WORK_CELLS_CLASS;\n        }\n        query = '.' + wrapper + '[data-date=\"' + startTime + '\"]';\n        if (this.parent.activeViewOptions.group.resources.length > 0) {\n            query = query + '[data-group-index=\"' + this.actionObj.groupIndex + '\"]';\n        }\n        this.targetTd = this.parent.element.querySelector(query);\n        if (isNullOrUndefined(this.targetTd)) {\n            return -1;\n        }\n        return this.targetTd.cellIndex;\n    };\n    DragAndDrop.prototype.updateEventHeight = function (event, index, colIndex) {\n        this.verticalEvent.initializeValues();\n        var datesCount = 0;\n        if (!this.parent.uiStateValues.isGroupAdaptive) {\n            for (var i = 0; i < this.actionObj.groupIndex; i++) {\n                datesCount = datesCount + this.verticalEvent.dateRender[i].length;\n            }\n        }\n        var indexGroup = this.parent.uiStateValues.isGroupAdaptive ? datesCount : this.actionObj.groupIndex;\n        var target = (this.parent.activeViewOptions.group.byDate &&\n            !isNullOrUndefined(this.parent.getDateFromElement(this.actionObj.target))) ? true : false;\n        if (target || !this.parent.activeViewOptions.group.byDate) {\n            var dynamicIndex = -1;\n            var dayIndex = !this.parent.activeViewOptions.group.byDate ?\n                isNullOrUndefined(index) ? this.actionObj.index - datesCount : colIndex - datesCount\n                : this.parent.getIndexOfDate(this.verticalEvent.dateRender[indexGroup], util.resetTime(\n                // eslint-disable-next-line max-len\n                this.parent.getDateFromElement(isNullOrUndefined(index) ? this.actionObj.target : this.targetTd)));\n            var splitEvents = this.splitEvent(event);\n            var events_1 = event[this.parent.eventFields.isAllDay] ||\n                this.parent.eventBase.isAllDayAppointment(event) || splitEvents.length > 2 ? [event] : splitEvents;\n            for (var i = 0; i < events_1.length; i++) {\n                if (i > 0) {\n                    var filterQuery = \".e-day-wrapper[data-date=\\\"\" + util.resetTime(events_1[i][this.parent.eventFields.startTime]).getTime() + \"\\\"]\";\n                    if (this.parent.activeViewOptions.group.resources.length > 0) {\n                        filterQuery = filterQuery.concat('[data-group-index = \"' + this.actionObj.groupIndex + '\"]');\n                    }\n                    var appWrap = this.parent.element.querySelector(filterQuery);\n                    if (appWrap) {\n                        dayIndex = dayIndex + 1;\n                        dynamicIndex = appWrap.cellIndex;\n                    }\n                    else {\n                        dayIndex = -1;\n                    }\n                }\n                if (dayIndex >= 0) {\n                    var record = this.verticalEvent.isSpannedEvent(events_1[i], dayIndex, indexGroup);\n                    var eStart = record[this.verticalEvent.fields.startTime];\n                    var eEnd = record[this.verticalEvent.fields.endTime];\n                    var appHeight = this.parent.activeViewOptions.timeScale.enable ? this.verticalEvent.getHeight(eStart, eEnd) :\n                        this.actionObj.element.offsetHeight;\n                    var topValue = this.parent.activeViewOptions.timeScale.enable ?\n                        this.verticalEvent.getTopValue(eStart, dayIndex, indexGroup) : this.actionObj.element.offsetTop;\n                    if (isNullOrUndefined(index)) {\n                        if (i === 0) {\n                            this.actionObj.clone.style.top = formatUnit(topValue);\n                            this.actionObj.clone.style.height = formatUnit(appHeight);\n                        }\n                        else {\n                            this.renderSpannedEvents(record, dynamicIndex, topValue, appHeight);\n                        }\n                    }\n                    else {\n                        var appWidth = this.actionObj.cellWidth;\n                        if (event[this.parent.eventFields.isAllDay]) {\n                            topValue = this.parent.element.querySelector('.' + cls.ALLDAY_ROW_CLASS).offsetTop;\n                            appHeight = this.getAllDayEventHeight();\n                            var timeDiff = event[this.parent.eventFields.endTime].getTime() -\n                                event[this.parent.eventFields.startTime].getTime();\n                            var allDayDifference = Math.ceil(timeDiff / (1000 * 3600 * 24));\n                            if (allDayDifference >= 0) {\n                                appWidth = (allDayDifference * this.actionObj.cellWidth);\n                            }\n                        }\n                        if (this.actionObj.cloneElement[index]) {\n                            if (i === 0) {\n                                this.actionObj.cloneElement[index].style.top = formatUnit(topValue);\n                                this.actionObj.cloneElement[index].style.height = formatUnit(appHeight);\n                                this.actionObj.cloneElement[index].style.width = formatUnit(appWidth);\n                                this.actionObj.cloneElement[index].style.left = formatUnit(0);\n                            }\n                            else {\n                                this.renderSpannedEvents(record, dynamicIndex, topValue, appHeight);\n                            }\n                        }\n                    }\n                }\n            }\n        }\n    };\n    DragAndDrop.prototype.renderSpannedEvents = function (record, index, top, height) {\n        var startTime = record[this.parent.eventFields.startTime].getTime();\n        var endTime = record[this.parent.eventFields.endTime].getTime();\n        if (startTime !== endTime) {\n            var appointmentElement = this.verticalEvent.\n                createAppointmentElement(record, false, record.isSpanned, this.actionObj.groupIndex);\n            addClass([appointmentElement], [cls.CLONE_ELEMENT_CLASS, 'e-dynamic-clone']);\n            setStyleAttribute(appointmentElement, {\n                'width': '100%',\n                'height': height + 'px',\n                'top': top + 'px',\n                'border': '0px'\n            });\n            var appointmentWrap = [].slice.call(this.parent.element.querySelectorAll('.' + cls.APPOINTMENT_WRAPPER_CLASS));\n            appointmentWrap[index].appendChild(appointmentElement);\n        }\n    };\n    DragAndDrop.prototype.getRenderedDates = function () {\n        var _this = this;\n        var _a, _b;\n        var renderDates = this.parent.activeView.renderDates;\n        (_a = this.parent.eventBase.slots).push.apply(_a, this.parent.activeView.renderDates.map(function (date) { return +date; }));\n        if (this.parent.activeViewOptions.group.resources.length > 0) {\n            this.parent.eventBase.slots = [];\n            var resources = this.parent.resourceBase.lastResourceLevel.\n                filter(function (res) { return res.groupIndex === _this.actionObj.groupIndex; });\n            renderDates = resources[0].renderDates;\n            (_b = this.parent.eventBase.slots).push.apply(_b, renderDates.map(function (date) { return +date; }));\n        }\n        return renderDates;\n    };\n    DragAndDrop.prototype.updateAllDayEvents = function (startDate, endDate, colIndex) {\n        this.parent.eventBase.slots = [];\n        var event = this.getUpdatedEvent(startDate, endDate, this.actionObj.event);\n        var renderDates = this.getRenderedDates();\n        var events = this.parent.eventBase.splitEvent(event, renderDates);\n        var query = \".e-all-day-cells[data-date=\\\"\" + events[0][this.parent.eventFields.startTime].getTime() + \"\\\"]\";\n        if (this.parent.activeViewOptions.group.resources.length > 0) {\n            query = query.concat('[data-group-index = \"' + this.actionObj.groupIndex + '\"]');\n        }\n        var cell = [].slice.call(this.parent.element.querySelectorAll(query));\n        if (cell.length > 0 || !isNullOrUndefined(colIndex)) {\n            var cellIndex = !isNullOrUndefined(colIndex) ? colIndex : cell[0].cellIndex;\n            this.appendCloneElement(this.getEventWrapper(cellIndex));\n            // eslint-disable-next-line max-len\n            this.actionObj.clone.style.width = formatUnit(events[0].data.count * this.actionObj.cellWidth);\n        }\n    };\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    DragAndDrop.prototype.swapDragging = function (e) {\n        var colIndex = closest(this.actionObj.target, 'td').cellIndex;\n        if (closest(this.actionObj.target, '.' + cls.DATE_HEADER_WRAP_CLASS) &&\n            !closest(this.actionObj.clone, '.' + cls.ALLDAY_APPOINTMENT_WRAPPER_CLASS)) {\n            addClass([this.actionObj.clone], cls.ALLDAY_APPOINTMENT_CLASS);\n            this.appendCloneElement(this.getEventWrapper(colIndex));\n            this.actionObj.isAllDay = true;\n            var eventHeight = this.getAllDayEventHeight();\n            var allDayElement = [].slice.call(this.parent.element.querySelectorAll('.' + cls.ALLDAY_CELLS_CLASS + ':first-child'));\n            if (allDayElement[0].offsetHeight < eventHeight) {\n                for (var _i = 0, allDayElement_1 = allDayElement; _i < allDayElement_1.length; _i++) {\n                    var element = allDayElement_1[_i];\n                    element.style.height = ((eventHeight + 2) / 12) + 'em';\n                }\n            }\n            setStyleAttribute(this.actionObj.clone, {\n                width: formatUnit(this.actionObj.cellWidth),\n                height: formatUnit(eventHeight),\n                top: formatUnit(this.parent.element.querySelector('.' + cls.ALLDAY_ROW_CLASS).offsetTop)\n            });\n        }\n        if (closest(this.actionObj.target, '.' + cls.WORK_CELLS_CLASS) &&\n            !closest(this.actionObj.clone, '.' + cls.DAY_WRAPPER_CLASS)) {\n            removeClass([this.actionObj.clone], cls.ALLDAY_APPOINTMENT_CLASS);\n            this.appendCloneElement(this.getEventWrapper(colIndex));\n            this.actionObj.isAllDay = false;\n            // eslint-disable-next-line max-len\n            var height = (this.actionObj.element.offsetHeight === 0) ? this.actionObj.height : this.actionObj.element.offsetHeight;\n            setStyleAttribute(this.actionObj.clone, {\n                left: formatUnit(0),\n                height: formatUnit(height),\n                width: formatUnit(this.actionObj.cellWidth)\n            });\n        }\n    };\n    DragAndDrop.prototype.calculateVerticalDate = function (e) {\n        if (isNullOrUndefined(e.target) || (e.target && isNullOrUndefined(closest(e.target, 'tr'))) ||\n            (e.target && e.target.tagName === 'DIV')) {\n            return;\n        }\n        var eventObj = extend({}, this.actionObj.event, null, true);\n        if (isNullOrUndefined(this.parent.eventDragArea)) {\n            this.removeCloneElement();\n        }\n        var eventDuration = eventObj[this.parent.eventFields.endTime].getTime() -\n            eventObj[this.parent.eventFields.startTime].getTime();\n        var td = closest(this.actionObj.target, 'td');\n        if (!isNullOrUndefined(td)) {\n            var tr = td.parentElement;\n            this.actionObj.index = (tr.rowIndex * tr.children.length) + td.cellIndex;\n            var workCells = [].slice.call(this.parent.element.querySelectorAll('.' + cls.WORK_CELLS_CLASS));\n            td = workCells[this.actionObj.index];\n            var currentDate = this.parent.getDateFromElement(td);\n            if (!isNullOrUndefined(currentDate)) {\n                if (this.parent.activeViewOptions.group.resources.length > 0) {\n                    this.actionObj.groupIndex = parseInt(td.getAttribute('data-group-index'), 10);\n                }\n                var timeString = new Date(currentDate.setDate(currentDate.getDate() - this.daysVariation));\n                var dragStart = new Date(timeString.getTime());\n                var dragEnd = new Date(dragStart.getTime());\n                var startTimeDiff = eventObj[this.parent.eventFields.startTime].getTime() -\n                    (util.resetTime(new Date(+eventObj[this.parent.eventFields.startTime]))).getTime();\n                dragStart = new Date(dragStart.getTime() + startTimeDiff);\n                dragEnd = new Date(dragStart.getTime() + eventDuration);\n                this.actionObj.start = new Date(dragStart.getTime());\n                this.actionObj.end = new Date(dragEnd.getTime());\n            }\n        }\n        var event = this.getUpdatedEvent(this.actionObj.start, this.actionObj.end, this.actionObj.event);\n        var eventWrappers = [].slice.call(this.parent.element.querySelectorAll('.' + cls.CLONE_ELEMENT_CLASS));\n        for (var _i = 0, eventWrappers_1 = eventWrappers; _i < eventWrappers_1.length; _i++) {\n            var wrapper = eventWrappers_1[_i];\n            remove(wrapper);\n        }\n        if (this.multiData && this.multiData.length > 0) {\n            var startTime = util.resetTime(new Date(event[this.parent.eventFields.startTime]));\n            var startTimeDiff = startTime.getTime() - this.startTime;\n            if (this.parent.currentView === 'TimelineYear' && this.parent.group.resources.length > 0) {\n                startTimeDiff = (startTime.getFullYear() - new Date(this.startTime).getFullYear()) * 12;\n                startTimeDiff -= new Date(this.startTime).getMonth();\n                startTimeDiff += startTime.getMonth();\n            }\n            for (var index = 0; index < this.multiData.length; index++) {\n                this.updatedData[index] = this.updateMultipleVerticalDate(this.multiData[index], startTimeDiff);\n                if (this.parent.currentView === 'TimelineYear') {\n                    this.dynamicYearlyEventsRendering(this.updatedData[index]);\n                }\n                else {\n                    this.dynamicEventsRendering(this.updatedData[index]);\n                }\n            }\n        }\n        else {\n            if (this.parent.currentView === 'TimelineYear') {\n                this.dynamicYearlyEventsRendering(event);\n            }\n            else {\n                this.dynamicEventsRendering(event);\n            }\n        }\n    };\n    DragAndDrop.prototype.updateMultipleVerticalDate = function (data, timeDifference) {\n        var eventObj = extend({}, data, null, true);\n        var eventDuration = eventObj[this.parent.eventFields.endTime].getTime() -\n            eventObj[this.parent.eventFields.startTime].getTime();\n        var startDate = new Date(eventObj[this.parent.eventFields.startTime]);\n        if (this.parent.currentView === 'TimelineYear' && this.parent.group.resources.length > 0) {\n            eventObj[this.parent.eventFields.startTime] = new Date(startDate.setMonth(startDate.getMonth() + timeDifference));\n        }\n        else {\n            var differInDays = Math.ceil(timeDifference / util.MS_PER_DAY);\n            eventObj[this.parent.eventFields.startTime] = new Date(startDate.setDate(startDate.getDate() + differInDays));\n        }\n        eventObj[this.parent.eventFields.endTime] =\n            new Date(eventObj[this.parent.eventFields.startTime].getTime() + eventDuration);\n        return eventObj;\n    };\n    DragAndDrop.prototype.calculateTimelineTime = function (e) {\n        var eventObj = extend({}, this.actionObj.event, null, true);\n        var eventDuration = eventObj[this.parent.eventFields.endTime].getTime() -\n            eventObj[this.parent.eventFields.startTime].getTime();\n        var offsetLeft = this.parent.enableRtl ? Math.abs(this.actionObj.clone.offsetLeft) - this.actionObj.clone.offsetWidth :\n            parseInt(this.actionObj.clone.style.left, 10);\n        offsetLeft = Math.floor(offsetLeft / this.actionObj.cellWidth) * this.actionObj.cellWidth;\n        var rightOffset;\n        if (this.parent.enableRtl) {\n            rightOffset = Math.abs(parseInt(this.actionObj.clone.style.right, 10));\n            this.actionObj.clone.style.right = formatUnit(rightOffset);\n        }\n        offsetLeft = this.getOffsetValue(offsetLeft, rightOffset);\n        var colIndex = this.getColumnIndex(offsetLeft);\n        var dragArea = this.parent.element.querySelector('.' + cls.CONTENT_WRAP_CLASS);\n        var contentWrapRight = dragArea.getBoundingClientRect().right;\n        var cursorDrag = this.parent.activeView.isTimelineView() && !this.parent.enableRtl &&\n            this.actionObj.pageX > this.actionObj.clone.getBoundingClientRect().right &&\n            !this.isMorePopupOpened && !(this.actionObj.pageX > contentWrapRight);\n        var leftVal = (this.parent.eventDragArea) ? dragArea.scrollLeft - dragArea.offsetLeft : 0;\n        if ((this.isCursorAhead || cursorDrag) && !this.isStepDragging) {\n            this.isCursorAhead = true;\n        }\n        var cloneIndex = Math.floor((this.actionObj.pageX - this.actionObj.clone.getBoundingClientRect().left + leftVal) / this.actionObj.cellWidth);\n        if (this.parent.enableRtl) {\n            cloneIndex = Math.abs(Math.floor((this.actionObj.pageX - this.actionObj.clone.getBoundingClientRect().right) /\n                this.actionObj.cellWidth)) - 1;\n        }\n        if (this.cursorPointIndex < 0) {\n            this.cursorIndex(e, eventObj, offsetLeft, cloneIndex);\n        }\n        var tr = this.parent.getContentTable().querySelector('tr');\n        var index = this.getCursorCurrentIndex(colIndex, cloneIndex, tr);\n        index = index < 0 ? 0 : index;\n        var eventStart = this.isHeaderRows ? new Date(this.timelineEventModule.dateRender[index].getTime()) :\n            this.parent.getDateFromElement(tr.children[index]);\n        if (this.isStepDragging) {\n            var widthDiff = this.getWidthDiff(tr, index);\n            if (widthDiff !== 0) {\n                var timeDiff = Math.round(widthDiff / this.widthPerMinute);\n                eventStart.setMinutes(eventStart.getMinutes() + (timeDiff * this.actionObj.interval));\n                if (this.isCursorAhead || cursorDrag) {\n                    eventStart.setMilliseconds(-(eventDuration));\n                }\n                else {\n                    eventStart.setMinutes(eventStart.getMinutes() - this.minDiff);\n                }\n            }\n            else {\n                eventStart = this.actionObj.start;\n            }\n        }\n        else {\n            if (this.isCursorAhead || cursorDrag) {\n                eventStart.setMinutes(eventStart.getMinutes() +\n                    (this.isTimelineDayProcess ? MINUTES_PER_DAY : this.actionObj.slotInterval));\n                eventStart.setMilliseconds(-(eventDuration));\n            }\n            else {\n                eventStart.setMinutes(eventStart.getMinutes() -\n                    (this.cursorPointIndex * (this.isTimelineDayProcess ? MINUTES_PER_DAY : this.actionObj.slotInterval)));\n            }\n        }\n        eventStart = this.calculateIntervalTime(eventStart);\n        if (this.isTimelineDayProcess) {\n            var eventSrt = eventObj[this.parent.eventFields.startTime];\n            eventStart.setHours(eventSrt.getHours(), eventSrt.getMinutes(), eventSrt.getSeconds());\n        }\n        var eventEnd = new Date(eventStart.getTime());\n        eventEnd.setMilliseconds(eventDuration);\n        var eventsData = [this.getUpdatedEvent(eventStart, eventEnd, this.actionObj.event)];\n        if (this.multiData.length > 0) {\n            var startTimeDiff = eventsData[0][this.parent.eventFields.startTime].getTime() - this.startTime;\n            for (var i = 0; i < this.multiData.length; i++) {\n                this.updatedData[i] = this.updateMultipleData(this.multiData[i], startTimeDiff);\n            }\n            eventsData = this.updatedData;\n        }\n        for (var dataIndex = 0; dataIndex < eventsData.length; dataIndex++) {\n            var events_2 = this.timelineEventModule.splitEvent(eventsData[dataIndex], this.timelineEventModule.dateRender);\n            var eventData = events_2[0].data;\n            var startTime = this.timelineEventModule.getStartTime(events_2[0], eventData);\n            var endTime = this.timelineEventModule.getEndTime(events_2[0], eventData);\n            // eslint-disable-next-line max-len\n            var width = this.timelineEventModule.getEventWidth(startTime, endTime, eventObj[this.parent.eventFields.isAllDay], eventData.count);\n            // eslint-disable-next-line max-len\n            var day = this.parent.getIndexOfDate(this.timelineEventModule.dateRender, util.resetTime(new Date(startTime.getTime())));\n            day = day < 0 ? 0 : day;\n            var left = this.timelineEventModule.getPosition(startTime, endTime, eventObj[this.parent.eventFields.isAllDay], day);\n            var cloneElement = this.multiData.length > 0 ? this.actionObj.cloneElement[dataIndex] : this.actionObj.clone;\n            if (this.parent.enableRtl) {\n                cloneElement.style.right = formatUnit(left);\n            }\n            else {\n                cloneElement.style.left = formatUnit(left);\n            }\n            if (!this.isMorePopupOpened) {\n                cloneElement.style.width = formatUnit(width);\n            }\n            if (this.parent.activeViewOptions.group.resources.length > 0) {\n                this.calculateResourceGroupingPosition(e, cloneElement);\n            }\n            this.actionObj.start = new Date(eventStart.getTime());\n            this.actionObj.end = new Date(eventEnd.getTime());\n            this.updateTimePosition(this.actionObj.start, this.updatedData);\n        }\n    };\n    DragAndDrop.prototype.getOffsetValue = function (offsetLeft, rightOffset) {\n        if (this.scrollEdges.left || this.scrollEdges.right) {\n            var viewEle = this.parent.element.querySelector('.' + cls.CONTENT_WRAP_CLASS);\n            if (this.parent.enableRtl) {\n                rightOffset = viewEle.offsetWidth - viewEle.scrollLeft;\n                if (this.scrollEdges.right) {\n                    rightOffset = (rightOffset - viewEle.offsetWidth + this.actionObj.clone.offsetWidth) -\n                        (this.actionObj.clone.offsetWidth - this.widthUptoCursorPoint);\n                }\n                else {\n                    rightOffset = rightOffset + this.widthUptoCursorPoint;\n                    if (rightOffset - this.widthUptoCursorPoint >= viewEle.scrollWidth) {\n                        this.actionObj.clone.style.width =\n                            formatUnit(this.actionObj.clone.offsetWidth - this.widthUptoCursorPoint + this.actionObj.cellWidth);\n                        rightOffset = (viewEle.scrollLeft - viewEle.scrollWidth);\n                    }\n                }\n                this.actionObj.clone.style.left = formatUnit(rightOffset);\n            }\n            else {\n                if (this.scrollEdges.left) {\n                    offsetLeft = viewEle.scrollLeft - this.widthUptoCursorPoint + this.actionObj.cellWidth;\n                    if (viewEle.scrollLeft + viewEle.offsetWidth >= viewEle.offsetWidth) {\n                        viewEle.scrollLeft = viewEle.scrollLeft - 1;\n                    }\n                    else if (this.actionObj.clone.offsetLeft === 0) {\n                        offsetLeft = viewEle.scrollLeft;\n                    }\n                }\n                else {\n                    offsetLeft = (viewEle.scrollLeft + viewEle.offsetWidth -\n                        this.actionObj.clone.offsetWidth) + (this.actionObj.clone.offsetWidth - this.widthUptoCursorPoint);\n                }\n                offsetLeft = offsetLeft < 0 ? 0 : offsetLeft;\n                this.actionObj.clone.style.left = formatUnit(offsetLeft);\n            }\n        }\n        return offsetLeft;\n    };\n    DragAndDrop.prototype.getWidthDiff = function (tr, index) {\n        var pages = this.scrollArgs.element.getBoundingClientRect();\n        if (pages.left <= this.actionObj.pageX && pages.right >= this.actionObj.pageX) {\n            var targetLeft = tr.children[index].offsetLeft;\n            var pageX = this.actionObj.pageX - pages.left;\n            if (this.parent.enableRtl) {\n                return (targetLeft + this.actionObj.cellWidth) - (this.scrollArgs.element.scrollLeft + pageX);\n            }\n            else {\n                return (this.scrollArgs.element.scrollLeft + pageX) - targetLeft;\n            }\n        }\n        return 0;\n    };\n    DragAndDrop.prototype.getColumnIndex = function (offsetLeft) {\n        var index = Math.floor(offsetLeft / this.actionObj.cellWidth);\n        if (this.isHeaderRows) {\n            return index;\n        }\n        return this.getIndex(index);\n    };\n    DragAndDrop.prototype.getCursorCurrentIndex = function (colIndex, cloneIndex, tr) {\n        var index = colIndex + cloneIndex;\n        if (this.isHeaderRows) {\n            var dateLength = Math.floor(tr.offsetWidth / this.actionObj.cellWidth);\n            return (index > dateLength - 1) ? dateLength - 1 : index;\n        }\n        return (index > tr.children.length - 1) ? tr.children.length - 1 : index;\n    };\n    DragAndDrop.prototype.cursorIndex = function (e, event, left, index) {\n        var td = closest(e.target, '.e-work-cells');\n        if (!isNullOrUndefined(td) && !this.isMorePopupOpened) {\n            var targetDate = this.parent.getDateFromElement(td);\n            if (this.isHeaderRows) {\n                var currentIndex = Math.floor(left / this.actionObj.cellWidth);\n                targetDate = new Date(this.timelineEventModule.dateRender[currentIndex + index].getTime());\n            }\n            var timeDiff = targetDate.getTime() - event[this.parent.eventFields.startTime].getTime();\n            if (this.isTimelineDayProcess) {\n                this.cursorPointIndex = Math.abs(Math.ceil(timeDiff / (util.MS_PER_DAY)));\n            }\n            else {\n                var widthDiff = Math.floor((timeDiff / util.MS_PER_MINUTE) / (this.actionObj.slotInterval / this.actionObj.cellWidth));\n                this.cursorPointIndex = Math.floor(widthDiff / this.actionObj.cellWidth);\n                this.cursorPointIndex = this.cursorPointIndex < 0 ? 0 : this.cursorPointIndex;\n            }\n        }\n        else {\n            this.cursorPointIndex = 0;\n        }\n    };\n    DragAndDrop.prototype.calculateResourceGroupingPosition = function (e, cloneElement) {\n        var dragArea = this.parent.element.querySelector('.' + cls.CONTENT_WRAP_CLASS);\n        var trCollection = [].slice.call(this.parent.element.querySelectorAll('.e-content-wrap .e-content-table tr:not(.e-hidden)'));\n        var translateY = util.getTranslateY(dragArea.querySelector('table'));\n        translateY = (isNullOrUndefined(translateY)) ? 0 : translateY;\n        var rowHeight = (this.parent.rowAutoHeight) ?\n            ~~(dragArea.querySelector('table').offsetHeight / trCollection.length) : this.actionObj.cellHeight;\n        var rowIndex = Math.floor(Math.floor((this.actionObj.Y +\n            (dragArea.scrollTop - translateY - (window.scrollY || window.pageYOffset))) -\n            dragArea.getBoundingClientRect().top) / rowHeight);\n        rowIndex = (rowIndex < 0) ? 0 : (rowIndex > trCollection.length - 1) ? trCollection.length - 1 : rowIndex;\n        this.actionObj.index = rowIndex;\n        var eventContainer = this.parent.element.querySelectorAll('.e-appointment-container:not(.e-hidden)').item(rowIndex);\n        var eventWrapper = eventContainer.querySelector('.' + cls.APPOINTMENT_WRAPPER_CLASS);\n        if (!eventWrapper) {\n            eventWrapper = createElement('div', { className: cls.APPOINTMENT_WRAPPER_CLASS });\n            eventContainer.appendChild(eventWrapper);\n        }\n        this.appendCloneElement(eventWrapper, cloneElement);\n        var td = closest(this.actionObj.target, 'td');\n        this.actionObj.groupIndex = (td && !isNaN(parseInt(td.getAttribute('data-group-index'), 10)))\n            ? parseInt(td.getAttribute('data-group-index'), 10) : this.actionObj.groupIndex;\n        var top = trCollection[rowIndex].getBoundingClientRect().height * rowIndex;\n        if (this.parent.rowAutoHeight) {\n            var cursorElement = this.getCursorElement(e);\n            if (cursorElement) {\n                top = cursorElement.classList.contains(cls.WORK_CELLS_CLASS) ? cursorElement.offsetTop :\n                    cursorElement.offsetParent.classList.contains(cls.APPOINTMENT_CLASS) ?\n                        cursorElement.offsetParent.offsetTop : top;\n            }\n        }\n        cloneElement.style.top = formatUnit(top);\n    };\n    DragAndDrop.prototype.appendCloneElement = function (element, cloneElement) {\n        if (cloneElement === void 0) { cloneElement = null; }\n        cloneElement = isNullOrUndefined(cloneElement) ? this.actionObj.clone : cloneElement;\n        var dragElement = document.querySelector(this.parent.eventDragArea);\n        if (this.parent.eventDragArea && dragElement) {\n            dragElement.appendChild(cloneElement);\n        }\n        else {\n            element.appendChild(cloneElement);\n        }\n    };\n    DragAndDrop.prototype.getEventWrapper = function (index, isAllDayDrag) {\n        var eventWrapper;\n        if (isNullOrUndefined(isAllDayDrag)) {\n            isAllDayDrag = this.actionObj.clone.classList.contains(cls.ALLDAY_APPOINTMENT_CLASS);\n        }\n        if (this.parent.activeViewOptions.timeScale.enable) {\n            var wrapperClass = isAllDayDrag ? '.' + cls.ALLDAY_APPOINTMENT_WRAPPER_CLASS : '.' + cls.APPOINTMENT_WRAPPER_CLASS;\n            eventWrapper = this.parent.element.querySelectorAll(wrapperClass).item(index);\n        }\n        else {\n            var targetWrapper = this.parent.element.querySelectorAll('.' + cls.WORK_CELLS_CLASS).item(index);\n            eventWrapper = targetWrapper.querySelector('.' + cls.APPOINTMENT_WRAPPER_CLASS);\n            if (!eventWrapper) {\n                eventWrapper = createElement('div', { className: cls.APPOINTMENT_WRAPPER_CLASS });\n                targetWrapper.appendChild(eventWrapper);\n            }\n        }\n        return eventWrapper;\n    };\n    DragAndDrop.prototype.getAllDayEventHeight = function () {\n        var eventWrapper = createElement('div', { className: cls.APPOINTMENT_CLASS });\n        this.parent.element.querySelector('.' + cls.ALLDAY_APPOINTMENT_WRAPPER_CLASS).appendChild(eventWrapper);\n        var eventHeight = eventWrapper.offsetHeight;\n        remove(eventWrapper);\n        return eventHeight;\n    };\n    DragAndDrop.prototype.isAllowDrop = function (e) {\n        if (!this.actionObj.excludeSelectors) {\n            return false;\n        }\n        var dropSelectors = this.actionObj.excludeSelectors.split(',');\n        var isAllowDrop = false;\n        for (var _i = 0, dropSelectors_1 = dropSelectors; _i < dropSelectors_1.length; _i++) {\n            var selector = dropSelectors_1[_i];\n            if (e.target.classList.contains(selector)) {\n                isAllowDrop = true;\n                break;\n            }\n        }\n        return isAllowDrop;\n    };\n    /**\n     * Get module name.\n     *\n     * @returns {string} Returns the module name\n     */\n    DragAndDrop.prototype.getModuleName = function () {\n        return 'dragAndDrop';\n    };\n    return DragAndDrop;\n}(ActionBase));\nexport { DragAndDrop };\n"]},"metadata":{},"sourceType":"module"}